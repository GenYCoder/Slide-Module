!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function e(e,t){var n=i.indexOf(e.charAt(t));if(-1==n)throw"Cannot decode base64";return n}function t(t){t=""+t;var n,r,i,o=t.length;if(0==o)return t;if(0!=o%4)throw"Cannot decode base64";n=0,t.charAt(o-1)==a&&(n=1,t.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6|e(t,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=e(t,r)<<18|e(t,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(e,t){var n=e.charCodeAt(t);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(e){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var t,r,o=[];e=""+e;var s=e.length-e.length%3;if(0==e.length)return e;for(t=0;s>t;t+=3)r=n(e,t)<<16|n(e,t+1)<<8|n(e,t+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(e.length-s){case 1:r=n(e,t)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(e,t)<<16|n(e,t+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:t}}())}(),function(e,t,n){"use strict";function r(){function e(e,n){return t.extend(new(t.extend(function(){},{prototype:e})),n)}function n(e,t){var n=t.caseInsensitiveMatch,r={originalPath:e,regexp:e},a=r.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(e,t,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),t=t||"",""+(i?"":t)+"(?:"+(i?t:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+e+"$",n?"i":""),r}var r={};this.when=function(e,a){if(r[e]=t.extend({reloadOnSearch:!0},a,e&&n(e,a)),e){var i="/"==e[e.length-1]?e.substr(0,e.length-1):e+"/";r[i]=t.extend({redirectTo:e},n(i,a))}return this},this.otherwise=function(e){return this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(e,t){var n=t.keys,r={};if(!t.regexp)return null;var a=t.regexp.exec(e);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function p(){var e=d(),r=m.current;e&&r&&e.$$route===r.$$route&&t.equals(e.pathParams,r.pathParams)&&!e.reloadOnSearch&&!g?(r.params=e.params,t.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(e||r)&&(g=!1,n.$broadcast("$routeChangeStart",e,r),m.current=e,e&&e.redirectTo&&(t.isString(e.redirectTo)?a.path(f(e.redirectTo,e.params)).search(e.params).replace():a.url(e.redirectTo(e.pathParams,a.path(),a.search())).replace()),o.when(e).then(function(){if(e){var n,r,a=t.extend({},e.resolve);return t.forEach(a,function(e,n){a[n]=t.isString(e)?s.get(e):s.invoke(e)}),t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(r=e.templateUrl)&&(t.isFunction(r)&&(r=r(e.params)),r=l.getTrustedResourceUrl(r),t.isDefined(r)&&(e.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(e){return e.data}))),t.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){e==m.current&&(e&&(e.locals=a,t.copy(e.params,i)),n.$broadcast("$routeChangeSuccess",e,r))},function(t){e==m.current&&n.$broadcast("$routeChangeError",e,r,t)}))}function d(){var n,i;return t.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=e(r,{params:t.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&e(r[null],{params:{},pathParams:{}})}function f(e,n){var r=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)r.push(e);else{var a=e.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(p)}};return n.$on("$locationChangeSuccess",p),m}]}function a(){this.$get=function(){return{}}}function i(e,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),p&&(r.leave(p),p=null)}function l(){var o=e.current&&e.current.locals,s=o&&o.$template;if(t.isDefined(s)){var l=a.$new(),g=e.current,m=c(l,function(e){r.enter(e,null,p||i,function(){!t.isDefined(d)||d&&!a.$eval(d)||n()}),u()});p=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(f)}else u()}var h,p,d=o.autoscroll,f=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(e,t,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=e(a.contents());if(i.controller){o.$scope=r;var c=t(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=t.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(e,t,n){"use strict";function r(e){var n=[];return c(n,t.noop).chars(e),n.join("")}function a(e){var t={};e=e.split(",");var n;for(n=0;n<e.length;n++)t[e[n]]=!0;return t}function i(e,n){function r(e,r,i,s){if(r=t.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(p,function(e,t,n,r,a){u[t]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(e,r){var a,i=0;if(r=t.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=e;for(c.last=function(){return c[c.length-1]};e;){if(s=!0,c.last()&&S[c.last()]?(e=e.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(e,t){return t=t.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(t)),""}),a("",c.last())):(0===e.indexOf("<!--")?(i=e.indexOf("--",4),i>=0&&e.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(e.substring(4,i)),e=e.substring(i+3),s=!1)):m.test(e)?(i=e.match(m))&&(e=e.replace(i[0],""),s=!1):f.test(e)?(i=e.match(h))&&(e=e.substring(i[0].length),i[0].replace(h,a),s=!1):d.test(e)&&(i=e.match(l))&&(e=e.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=e.indexOf("<"),s=0>i?e:e.substring(0,i),e=0>i?"":e.substring(i),n.chars&&n.chars(o(s)))),e==v)throw u("badparse",e);v=e}a()}function o(e){if(!e)return"";var t=E.exec(e);e=t[1];var n=t[3];return(t=t[2])&&(D.innerHTML=t.replace(/</g,"&lt;"),t="textContent"in D?D.textContent:D.innerText),e+t+n}function s(e){return e.replace(/&/g,"&amp;").replace(v,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,n){var r=!1,a=t.bind(e,e.push);return{start:function(e,i,o){e=t.lowercase(e),!r&&S[e]&&(r=e),r||!0!==y[e]||(a("<"),a(e),t.forEach(i,function(r,i){var o=t.lowercase(i),c="img"===e&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(e){e=t.lowercase(e),r||!0!==y[e]||(a("</"),a(e),a(">")),e==r&&(r=!1)},chars:function(e){r||a(s(e))}}}var u=t.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,p=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,d=/^</,f=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");e=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=t.extend({},n,e),x=t.extend({},e,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=t.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),S=a("script,style"),y=t.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=t.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(e){return function(t){var n=[];return i(t,c(n,function(t,n){return!/^unsafe/.test(e(t,n))})),n.join("")}}]}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(e){e&&d.push(r(e))}function c(e,n){d.push("<a "),t.isDefined(o)&&(d.push('target="'),d.push(o),d.push('" ')),d.push('href="'),d.push(e),d.push('">'),s(n),d.push("</a>")}if(!i)return i;for(var u,l,h,p=i,d=[];u=p.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(p.substr(0,h)),c(l,u[0].replace(a,"")),p=p.substring(h+u[0].length);return s(p),e(d.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(e,t){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(t,r){null!=n?r(n):e({url:t+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(e){n=e.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(e){alert("Cannot get digestValue.")})},getFileBuffer:function(e){var n=t.defer(),r=new FileReader;return r.onload=function(e){n.resolve(e.target.result)},r.onerror=function(e){n.reject(e.target.error)},r.readAsArrayBuffer(e),n.promise},addListFileAttachment:function(t,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(t,function(a){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(e){return e},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(e){o(e)},function(e){s(e)})})})},deleteListFileAttachment:function(t,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(t,function(s){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(e){i(e)},function(e){o(e)})})},getListItemType:function(e){return("SP.Data."+e[0].toUpperCase()+e.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(t,n,r,a,i,o){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){i(e)},function(e){o(e)})},getListItems:function(t,n,r,a,i){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){a(e)},function(e){i(e)})},addListItem:function(t,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(t,function(r){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(e){a(e)},function(e){i(e)})})},updateListItem:function(t,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(t,function(a){c(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":t.data.d.__metadata.etag}}).then(function(e){i(e)},function(e){o(e)})},function(e){o(e)})})},deleteListItem:function(t,n,r,a,i){var o=this.getListItem;this.getDigestValue(t,function(s){o(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":t.data.d.__metadata.etag}}).then(function(e){a(e)},function(e){i(e)})},function(e){i(e)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(e){return{$$silentChangePath:!1,silent:function(t,n){this.prev=e.path();var r=e.url(t);n&&r.replace(),this.$$silentChangePath=e.path()},box:function(e,t){t[e].__silentModeMarker||!function(){var n=t[e];t[e]=function(){t[e]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(e,t,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===t.path())for(var i in e.$$listeners.$locationChangeSuccess)n.box(i,e.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,e.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function e(e,t){var n=i.indexOf(e.charAt(t));if(-1==n)throw"Cannot decode base64";return n}function t(t){t=""+t;var n,r,i,o=t.length;if(0==o)return t;if(0!=o%4)throw"Cannot decode base64";n=0,t.charAt(o-1)==a&&(n=1,t.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6|e(t,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=e(t,r)<<18|e(t,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(e,t){var n=e.charCodeAt(t);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(e){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var t,r,o=[];e=""+e;var s=e.length-e.length%3;if(0==e.length)return e;for(t=0;s>t;t+=3)r=n(e,t)<<16|n(e,t+1)<<8|n(e,t+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(e.length-s){case 1:r=n(e,t)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(e,t)<<16|n(e,t+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:t}}())}(),function(e,t,n){"use strict";function r(){function e(e,n){return t.extend(new(t.extend(function(){},{prototype:e})),n)}function n(e,t){var n=t.caseInsensitiveMatch,r={originalPath:e,regexp:e},a=r.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(e,t,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),t=t||"",""+(i?"":t)+"(?:"+(i?t:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+e+"$",n?"i":""),r}var r={};this.when=function(e,a){if(r[e]=t.extend({reloadOnSearch:!0},a,e&&n(e,a)),e){var i="/"==e[e.length-1]?e.substr(0,e.length-1):e+"/";r[i]=t.extend({redirectTo:e},n(i,a))}return this},this.otherwise=function(e){return this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(e,t){var n=t.keys,r={};if(!t.regexp)return null;var a=t.regexp.exec(e);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function p(){var e=d(),r=m.current;e&&r&&e.$$route===r.$$route&&t.equals(e.pathParams,r.pathParams)&&!e.reloadOnSearch&&!g?(r.params=e.params,t.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(e||r)&&(g=!1,n.$broadcast("$routeChangeStart",e,r),m.current=e,e&&e.redirectTo&&(t.isString(e.redirectTo)?a.path(f(e.redirectTo,e.params)).search(e.params).replace():a.url(e.redirectTo(e.pathParams,a.path(),a.search())).replace()),o.when(e).then(function(){if(e){var n,r,a=t.extend({},e.resolve);return t.forEach(a,function(e,n){a[n]=t.isString(e)?s.get(e):s.invoke(e)}),t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(r=e.templateUrl)&&(t.isFunction(r)&&(r=r(e.params)),r=l.getTrustedResourceUrl(r),t.isDefined(r)&&(e.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(e){return e.data}))),t.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){e==m.current&&(e&&(e.locals=a,t.copy(e.params,i)),n.$broadcast("$routeChangeSuccess",e,r))},function(t){e==m.current&&n.$broadcast("$routeChangeError",e,r,t)}))}function d(){var n,i;return t.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=e(r,{params:t.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&e(r[null],{params:{},pathParams:{}})}function f(e,n){var r=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)r.push(e);else{var a=e.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(p)}};return n.$on("$locationChangeSuccess",p),m}]}function a(){this.$get=function(){return{}}}function i(e,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),p&&(r.leave(p),p=null)}function l(){var o=e.current&&e.current.locals,s=o&&o.$template;if(t.isDefined(s)){var l=a.$new(),g=e.current,m=c(l,function(e){r.enter(e,null,p||i,function(){!t.isDefined(d)||d&&!a.$eval(d)||n()}),u()});p=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(f)}else u()}var h,p,d=o.autoscroll,f=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(e,t,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=e(a.contents());if(i.controller){o.$scope=r;var c=t(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=t.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(e,t,n){"use strict";function r(e){var n=[];return c(n,t.noop).chars(e),n.join("")}function a(e){var t={};e=e.split(",");var n;for(n=0;n<e.length;n++)t[e[n]]=!0;return t}function i(e,n){function r(e,r,i,s){if(r=t.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(p,function(e,t,n,r,a){u[t]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(e,r){var a,i=0;if(r=t.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=e;for(c.last=function(){return c[c.length-1]};e;){if(s=!0,c.last()&&S[c.last()]?(e=e.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(e,t){return t=t.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(t)),""}),a("",c.last())):(0===e.indexOf("<!--")?(i=e.indexOf("--",4),i>=0&&e.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(e.substring(4,i)),e=e.substring(i+3),s=!1)):m.test(e)?(i=e.match(m))&&(e=e.replace(i[0],""),s=!1):f.test(e)?(i=e.match(h))&&(e=e.substring(i[0].length),i[0].replace(h,a),s=!1):d.test(e)&&(i=e.match(l))&&(e=e.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=e.indexOf("<"),s=0>i?e:e.substring(0,i),e=0>i?"":e.substring(i),n.chars&&n.chars(o(s)))),e==v)throw u("badparse",e);v=e}a()}function o(e){if(!e)return"";var t=E.exec(e);e=t[1];var n=t[3];return(t=t[2])&&(D.innerHTML=t.replace(/</g,"&lt;"),t="textContent"in D?D.textContent:D.innerText),e+t+n}function s(e){return e.replace(/&/g,"&amp;").replace(v,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,n){var r=!1,a=t.bind(e,e.push);return{start:function(e,i,o){e=t.lowercase(e),!r&&S[e]&&(r=e),r||!0!==y[e]||(a("<"),a(e),t.forEach(i,function(r,i){var o=t.lowercase(i),c="img"===e&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(e){e=t.lowercase(e),r||!0!==y[e]||(a("</"),a(e),a(">")),e==r&&(r=!1)},chars:function(e){r||a(s(e))}}}var u=t.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,p=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,d=/^</,f=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");e=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=t.extend({},n,e),x=t.extend({},e,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=t.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),S=a("script,style"),y=t.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=t.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(e){return function(t){var n=[];return i(t,c(n,function(t,n){return!/^unsafe/.test(e(t,n))})),n.join("")}}]}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(e){e&&d.push(r(e))}function c(e,n){d.push("<a "),t.isDefined(o)&&(d.push('target="'),d.push(o),d.push('" ')),d.push('href="'),d.push(e),d.push('">'),s(n),d.push("</a>")}if(!i)return i;for(var u,l,h,p=i,d=[];u=p.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(p.substr(0,h)),c(l,u[0].replace(a,"")),p=p.substring(h+u[0].length);return s(p),e(d.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(e,t){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(t,r){null!=n?r(n):e({url:t+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(e){n=e.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(e){alert("Cannot get digestValue.")})},getFileBuffer:function(e){var n=t.defer(),r=new FileReader;return r.onload=function(e){n.resolve(e.target.result)},r.onerror=function(e){n.reject(e.target.error)},r.readAsArrayBuffer(e),n.promise},addListFileAttachment:function(t,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(t,function(a){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(e){return e},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(e){o(e)},function(e){s(e)})})})},deleteListFileAttachment:function(t,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(t,function(s){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(e){i(e)},function(e){o(e)})})},getListItemType:function(e){return("SP.Data."+e[0].toUpperCase()+e.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(t,n,r,a,i,o){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){i(e)},function(e){o(e)})},getListItems:function(t,n,r,a,i){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){a(e)},function(e){i(e)})},addListItem:function(t,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(t,function(r){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(e){a(e)},function(e){i(e)})})},updateListItem:function(t,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(t,function(a){c(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":t.data.d.__metadata.etag}}).then(function(e){i(e)},function(e){o(e)})},function(e){o(e)})})},deleteListItem:function(t,n,r,a,i){var o=this.getListItem;this.getDigestValue(t,function(s){o(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":t.data.d.__metadata.etag}}).then(function(e){a(e)},function(e){i(e)})},function(e){i(e)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(e){return{$$silentChangePath:!1,silent:function(t,n){this.prev=e.path();var r=e.url(t);n&&r.replace(),this.$$silentChangePath=e.path()},box:function(e,t){t[e].__silentModeMarker||!function(){var n=t[e];t[e]=function(){t[e]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(e,t,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===t.path())for(var i in e.$$listeners.$locationChangeSuccess)n.box(i,e.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,e.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function e(e,t){var n=i.indexOf(e.charAt(t));if(-1==n)throw"Cannot decode base64";return n}function t(t){t=""+t;var n,r,i,o=t.length;if(0==o)return t;if(0!=o%4)throw"Cannot decode base64";n=0,t.charAt(o-1)==a&&(n=1,t.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6|e(t,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=e(t,r)<<18|e(t,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(e,t){var n=e.charCodeAt(t);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(e){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var t,r,o=[];e=""+e;var s=e.length-e.length%3;if(0==e.length)return e;for(t=0;s>t;t+=3)r=n(e,t)<<16|n(e,t+1)<<8|n(e,t+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(e.length-s){case 1:r=n(e,t)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(e,t)<<16|n(e,t+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:t}}())}(),function(e,t,n){"use strict";function r(){function e(e,n){return t.extend(new(t.extend(function(){},{prototype:e})),n)}function n(e,t){var n=t.caseInsensitiveMatch,r={originalPath:e,regexp:e},a=r.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(e,t,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),t=t||"",""+(i?"":t)+"(?:"+(i?t:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+e+"$",n?"i":""),r}var r={};this.when=function(e,a){if(r[e]=t.extend({reloadOnSearch:!0},a,e&&n(e,a)),e){var i="/"==e[e.length-1]?e.substr(0,e.length-1):e+"/";r[i]=t.extend({redirectTo:e},n(i,a))}return this},this.otherwise=function(e){return this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(e,t){var n=t.keys,r={};if(!t.regexp)return null;var a=t.regexp.exec(e);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function p(){var e=d(),r=m.current;e&&r&&e.$$route===r.$$route&&t.equals(e.pathParams,r.pathParams)&&!e.reloadOnSearch&&!g?(r.params=e.params,t.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(e||r)&&(g=!1,n.$broadcast("$routeChangeStart",e,r),m.current=e,e&&e.redirectTo&&(t.isString(e.redirectTo)?a.path(f(e.redirectTo,e.params)).search(e.params).replace():a.url(e.redirectTo(e.pathParams,a.path(),a.search())).replace()),o.when(e).then(function(){if(e){var n,r,a=t.extend({},e.resolve);return t.forEach(a,function(e,n){a[n]=t.isString(e)?s.get(e):s.invoke(e)}),t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(r=e.templateUrl)&&(t.isFunction(r)&&(r=r(e.params)),r=l.getTrustedResourceUrl(r),t.isDefined(r)&&(e.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(e){return e.data}))),t.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){e==m.current&&(e&&(e.locals=a,t.copy(e.params,i)),n.$broadcast("$routeChangeSuccess",e,r))},function(t){e==m.current&&n.$broadcast("$routeChangeError",e,r,t)}))}function d(){var n,i;return t.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=e(r,{params:t.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&e(r[null],{params:{},pathParams:{}})}function f(e,n){var r=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)r.push(e);else{var a=e.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(p)}};return n.$on("$locationChangeSuccess",p),m}]}function a(){this.$get=function(){return{}}}function i(e,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),p&&(r.leave(p),p=null)}function l(){var o=e.current&&e.current.locals,s=o&&o.$template;if(t.isDefined(s)){var l=a.$new(),g=e.current,m=c(l,function(e){r.enter(e,null,p||i,function(){!t.isDefined(d)||d&&!a.$eval(d)||n()}),u()});p=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(f)}else u()}var h,p,d=o.autoscroll,f=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(e,t,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=e(a.contents());if(i.controller){o.$scope=r;var c=t(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=t.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(e,t,n){"use strict";function r(e){var n=[];return c(n,t.noop).chars(e),n.join("")}function a(e){var t={};e=e.split(",");var n;for(n=0;n<e.length;n++)t[e[n]]=!0;return t}function i(e,n){function r(e,r,i,s){if(r=t.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(p,function(e,t,n,r,a){u[t]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(e,r){
var a,i=0;if(r=t.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=e;for(c.last=function(){return c[c.length-1]};e;){if(s=!0,c.last()&&S[c.last()]?(e=e.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(e,t){return t=t.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(t)),""}),a("",c.last())):(0===e.indexOf("<!--")?(i=e.indexOf("--",4),i>=0&&e.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(e.substring(4,i)),e=e.substring(i+3),s=!1)):m.test(e)?(i=e.match(m))&&(e=e.replace(i[0],""),s=!1):f.test(e)?(i=e.match(h))&&(e=e.substring(i[0].length),i[0].replace(h,a),s=!1):d.test(e)&&(i=e.match(l))&&(e=e.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=e.indexOf("<"),s=0>i?e:e.substring(0,i),e=0>i?"":e.substring(i),n.chars&&n.chars(o(s)))),e==v)throw u("badparse",e);v=e}a()}function o(e){if(!e)return"";var t=E.exec(e);e=t[1];var n=t[3];return(t=t[2])&&(D.innerHTML=t.replace(/</g,"&lt;"),t="textContent"in D?D.textContent:D.innerText),e+t+n}function s(e){return e.replace(/&/g,"&amp;").replace(v,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,n){var r=!1,a=t.bind(e,e.push);return{start:function(e,i,o){e=t.lowercase(e),!r&&S[e]&&(r=e),r||!0!==y[e]||(a("<"),a(e),t.forEach(i,function(r,i){var o=t.lowercase(i),c="img"===e&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(e){e=t.lowercase(e),r||!0!==y[e]||(a("</"),a(e),a(">")),e==r&&(r=!1)},chars:function(e){r||a(s(e))}}}var u=t.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,p=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,d=/^</,f=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");e=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=t.extend({},n,e),x=t.extend({},e,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=t.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),S=a("script,style"),y=t.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=t.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(e){return function(t){var n=[];return i(t,c(n,function(t,n){return!/^unsafe/.test(e(t,n))})),n.join("")}}]}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(e){e&&d.push(r(e))}function c(e,n){d.push("<a "),t.isDefined(o)&&(d.push('target="'),d.push(o),d.push('" ')),d.push('href="'),d.push(e),d.push('">'),s(n),d.push("</a>")}if(!i)return i;for(var u,l,h,p=i,d=[];u=p.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(p.substr(0,h)),c(l,u[0].replace(a,"")),p=p.substring(h+u[0].length);return s(p),e(d.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(e,t){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(t,r){null!=n?r(n):e({url:t+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(e){n=e.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(e){alert("Cannot get digestValue.")})},getFileBuffer:function(e){var n=t.defer(),r=new FileReader;return r.onload=function(e){n.resolve(e.target.result)},r.onerror=function(e){n.reject(e.target.error)},r.readAsArrayBuffer(e),n.promise},addListFileAttachment:function(t,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(t,function(a){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(e){return e},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(e){o(e)},function(e){s(e)})})})},deleteListFileAttachment:function(t,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(t,function(s){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(e){i(e)},function(e){o(e)})})},getListItemType:function(e){return("SP.Data."+e[0].toUpperCase()+e.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(t,n,r,a,i,o){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){i(e)},function(e){o(e)})},getListItems:function(t,n,r,a,i){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){a(e)},function(e){i(e)})},addListItem:function(t,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(t,function(r){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(e){a(e)},function(e){i(e)})})},updateListItem:function(t,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(t,function(a){c(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":t.data.d.__metadata.etag}}).then(function(e){i(e)},function(e){o(e)})},function(e){o(e)})})},deleteListItem:function(t,n,r,a,i){var o=this.getListItem;this.getDigestValue(t,function(s){o(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":t.data.d.__metadata.etag}}).then(function(e){a(e)},function(e){i(e)})},function(e){i(e)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(e){return{$$silentChangePath:!1,silent:function(t,n){this.prev=e.path();var r=e.url(t);n&&r.replace(),this.$$silentChangePath=e.path()},box:function(e,t){t[e].__silentModeMarker||!function(){var n=t[e];t[e]=function(){t[e]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(e,t,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===t.path())for(var i in e.$$listeners.$locationChangeSuccess)n.box(i,e.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,e.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function e(e,t){var n=i.indexOf(e.charAt(t));if(-1==n)throw"Cannot decode base64";return n}function t(t){t=""+t;var n,r,i,o=t.length;if(0==o)return t;if(0!=o%4)throw"Cannot decode base64";n=0,t.charAt(o-1)==a&&(n=1,t.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6|e(t,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=e(t,r)<<18|e(t,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(e,t){var n=e.charCodeAt(t);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(e){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var t,r,o=[];e=""+e;var s=e.length-e.length%3;if(0==e.length)return e;for(t=0;s>t;t+=3)r=n(e,t)<<16|n(e,t+1)<<8|n(e,t+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(e.length-s){case 1:r=n(e,t)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(e,t)<<16|n(e,t+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:t}}())}(),function(e,t,n){"use strict";function r(){function e(e,n){return t.extend(new(t.extend(function(){},{prototype:e})),n)}function n(e,t){var n=t.caseInsensitiveMatch,r={originalPath:e,regexp:e},a=r.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(e,t,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),t=t||"",""+(i?"":t)+"(?:"+(i?t:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+e+"$",n?"i":""),r}var r={};this.when=function(e,a){if(r[e]=t.extend({reloadOnSearch:!0},a,e&&n(e,a)),e){var i="/"==e[e.length-1]?e.substr(0,e.length-1):e+"/";r[i]=t.extend({redirectTo:e},n(i,a))}return this},this.otherwise=function(e){return this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(e,t){var n=t.keys,r={};if(!t.regexp)return null;var a=t.regexp.exec(e);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function p(){var e=d(),r=m.current;e&&r&&e.$$route===r.$$route&&t.equals(e.pathParams,r.pathParams)&&!e.reloadOnSearch&&!g?(r.params=e.params,t.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(e||r)&&(g=!1,n.$broadcast("$routeChangeStart",e,r),m.current=e,e&&e.redirectTo&&(t.isString(e.redirectTo)?a.path(f(e.redirectTo,e.params)).search(e.params).replace():a.url(e.redirectTo(e.pathParams,a.path(),a.search())).replace()),o.when(e).then(function(){if(e){var n,r,a=t.extend({},e.resolve);return t.forEach(a,function(e,n){a[n]=t.isString(e)?s.get(e):s.invoke(e)}),t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(r=e.templateUrl)&&(t.isFunction(r)&&(r=r(e.params)),r=l.getTrustedResourceUrl(r),t.isDefined(r)&&(e.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(e){return e.data}))),t.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){e==m.current&&(e&&(e.locals=a,t.copy(e.params,i)),n.$broadcast("$routeChangeSuccess",e,r))},function(t){e==m.current&&n.$broadcast("$routeChangeError",e,r,t)}))}function d(){var n,i;return t.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=e(r,{params:t.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&e(r[null],{params:{},pathParams:{}})}function f(e,n){var r=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)r.push(e);else{var a=e.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(p)}};return n.$on("$locationChangeSuccess",p),m}]}function a(){this.$get=function(){return{}}}function i(e,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),p&&(r.leave(p),p=null)}function l(){var o=e.current&&e.current.locals,s=o&&o.$template;if(t.isDefined(s)){var l=a.$new(),g=e.current,m=c(l,function(e){r.enter(e,null,p||i,function(){!t.isDefined(d)||d&&!a.$eval(d)||n()}),u()});p=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(f)}else u()}var h,p,d=o.autoscroll,f=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(e,t,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=e(a.contents());if(i.controller){o.$scope=r;var c=t(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=t.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(e,t,n){"use strict";function r(e){var n=[];return c(n,t.noop).chars(e),n.join("")}function a(e){var t={};e=e.split(",");var n;for(n=0;n<e.length;n++)t[e[n]]=!0;return t}function i(e,n){function r(e,r,i,s){if(r=t.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(p,function(e,t,n,r,a){u[t]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(e,r){var a,i=0;if(r=t.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=e;for(c.last=function(){return c[c.length-1]};e;){if(s=!0,c.last()&&S[c.last()]?(e=e.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(e,t){return t=t.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(t)),""}),a("",c.last())):(0===e.indexOf("<!--")?(i=e.indexOf("--",4),i>=0&&e.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(e.substring(4,i)),e=e.substring(i+3),s=!1)):m.test(e)?(i=e.match(m))&&(e=e.replace(i[0],""),s=!1):f.test(e)?(i=e.match(h))&&(e=e.substring(i[0].length),i[0].replace(h,a),s=!1):d.test(e)&&(i=e.match(l))&&(e=e.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=e.indexOf("<"),s=0>i?e:e.substring(0,i),e=0>i?"":e.substring(i),n.chars&&n.chars(o(s)))),e==v)throw u("badparse",e);v=e}a()}function o(e){if(!e)return"";var t=E.exec(e);e=t[1];var n=t[3];return(t=t[2])&&(D.innerHTML=t.replace(/</g,"&lt;"),t="textContent"in D?D.textContent:D.innerText),e+t+n}function s(e){return e.replace(/&/g,"&amp;").replace(v,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,n){var r=!1,a=t.bind(e,e.push);return{start:function(e,i,o){e=t.lowercase(e),!r&&S[e]&&(r=e),r||!0!==y[e]||(a("<"),a(e),t.forEach(i,function(r,i){var o=t.lowercase(i),c="img"===e&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(e){e=t.lowercase(e),r||!0!==y[e]||(a("</"),a(e),a(">")),e==r&&(r=!1)},chars:function(e){r||a(s(e))}}}var u=t.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,p=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,d=/^</,f=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");e=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=t.extend({},n,e),x=t.extend({},e,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=t.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),S=a("script,style"),y=t.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=t.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(e){return function(t){var n=[];return i(t,c(n,function(t,n){return!/^unsafe/.test(e(t,n))})),n.join("")}}]}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(e){e&&d.push(r(e))}function c(e,n){d.push("<a "),t.isDefined(o)&&(d.push('target="'),d.push(o),d.push('" ')),d.push('href="'),d.push(e),d.push('">'),s(n),d.push("</a>")}if(!i)return i;for(var u,l,h,p=i,d=[];u=p.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(p.substr(0,h)),c(l,u[0].replace(a,"")),p=p.substring(h+u[0].length);return s(p),e(d.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(e,t){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(t,r){null!=n?r(n):e({url:t+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(e){n=e.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(e){alert("Cannot get digestValue.")})},getFileBuffer:function(e){var n=t.defer(),r=new FileReader;return r.onload=function(e){n.resolve(e.target.result)},r.onerror=function(e){n.reject(e.target.error)},r.readAsArrayBuffer(e),n.promise},addListFileAttachment:function(t,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(t,function(a){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(e){return e},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(e){o(e)},function(e){s(e)})})})},deleteListFileAttachment:function(t,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(t,function(s){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(e){i(e)},function(e){o(e)})})},getListItemType:function(e){return("SP.Data."+e[0].toUpperCase()+e.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(t,n,r,a,i,o){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){i(e)},function(e){o(e)})},getListItems:function(t,n,r,a,i){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){a(e)},function(e){i(e)})},addListItem:function(t,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(t,function(r){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(e){a(e)},function(e){i(e)})})},updateListItem:function(t,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(t,function(a){c(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":t.data.d.__metadata.etag}}).then(function(e){i(e)},function(e){o(e)})},function(e){o(e)})})},deleteListItem:function(t,n,r,a,i){var o=this.getListItem;this.getDigestValue(t,function(s){o(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":t.data.d.__metadata.etag}}).then(function(e){a(e)},function(e){i(e)})},function(e){i(e)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(e){return{$$silentChangePath:!1,silent:function(t,n){this.prev=e.path();var r=e.url(t);n&&r.replace(),this.$$silentChangePath=e.path()},box:function(e,t){t[e].__silentModeMarker||!function(){var n=t[e];t[e]=function(){t[e]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(e,t,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===t.path())for(var i in e.$$listeners.$locationChangeSuccess)n.box(i,e.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,e.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function e(e,t){var n=i.indexOf(e.charAt(t));if(-1==n)throw"Cannot decode base64";return n}function t(t){t=""+t;var n,r,i,o=t.length;if(0==o)return t;if(0!=o%4)throw"Cannot decode base64";n=0,t.charAt(o-1)==a&&(n=1,t.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6|e(t,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=e(t,r)<<18|e(t,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(e,t){var n=e.charCodeAt(t);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(e){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var t,r,o=[];e=""+e;var s=e.length-e.length%3;if(0==e.length)return e;for(t=0;s>t;t+=3)r=n(e,t)<<16|n(e,t+1)<<8|n(e,t+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(e.length-s){case 1:r=n(e,t)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(e,t)<<16|n(e,t+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:t}}())}(),function(e,t,n){"use strict";function r(){function e(e,n){return t.extend(new(t.extend(function(){},{prototype:e})),n)}function n(e,t){var n=t.caseInsensitiveMatch,r={originalPath:e,regexp:e},a=r.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(e,t,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),t=t||"",""+(i?"":t)+"(?:"+(i?t:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+e+"$",n?"i":""),r}var r={};this.when=function(e,a){if(r[e]=t.extend({reloadOnSearch:!0},a,e&&n(e,a)),e){var i="/"==e[e.length-1]?e.substr(0,e.length-1):e+"/";r[i]=t.extend({redirectTo:e},n(i,a))}return this},this.otherwise=function(e){return this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(e,t){var n=t.keys,r={};if(!t.regexp)return null;var a=t.regexp.exec(e);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function p(){var e=d(),r=m.current;e&&r&&e.$$route===r.$$route&&t.equals(e.pathParams,r.pathParams)&&!e.reloadOnSearch&&!g?(r.params=e.params,t.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(e||r)&&(g=!1,n.$broadcast("$routeChangeStart",e,r),m.current=e,e&&e.redirectTo&&(t.isString(e.redirectTo)?a.path(f(e.redirectTo,e.params)).search(e.params).replace():a.url(e.redirectTo(e.pathParams,a.path(),a.search())).replace()),o.when(e).then(function(){if(e){var n,r,a=t.extend({},e.resolve);return t.forEach(a,function(e,n){a[n]=t.isString(e)?s.get(e):s.invoke(e)}),t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(r=e.templateUrl)&&(t.isFunction(r)&&(r=r(e.params)),r=l.getTrustedResourceUrl(r),t.isDefined(r)&&(e.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(e){return e.data}))),t.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){e==m.current&&(e&&(e.locals=a,t.copy(e.params,i)),n.$broadcast("$routeChangeSuccess",e,r))},function(t){e==m.current&&n.$broadcast("$routeChangeError",e,r,t)}))}function d(){var n,i;return t.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=e(r,{params:t.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&e(r[null],{params:{},pathParams:{}})}function f(e,n){var r=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)r.push(e);else{var a=e.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(p)}};return n.$on("$locationChangeSuccess",p),m}]}function a(){this.$get=function(){return{}}}function i(e,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),p&&(r.leave(p),p=null)}function l(){var o=e.current&&e.current.locals,s=o&&o.$template;if(t.isDefined(s)){var l=a.$new(),g=e.current,m=c(l,function(e){r.enter(e,null,p||i,function(){!t.isDefined(d)||d&&!a.$eval(d)||n()}),u()});p=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(f)}else u()}var h,p,d=o.autoscroll,f=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(e,t,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=e(a.contents());if(i.controller){o.$scope=r;var c=t(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=t.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(e,t,n){"use strict";function r(e){var n=[];return c(n,t.noop).chars(e),n.join("")}function a(e){var t={};e=e.split(",");var n;for(n=0;n<e.length;n++)t[e[n]]=!0;return t}function i(e,n){function r(e,r,i,s){if(r=t.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(p,function(e,t,n,r,a){u[t]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(e,r){var a,i=0;if(r=t.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=e;for(c.last=function(){return c[c.length-1]};e;){if(s=!0,c.last()&&S[c.last()]?(e=e.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(e,t){return t=t.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(t)),""}),a("",c.last())):(0===e.indexOf("<!--")?(i=e.indexOf("--",4),i>=0&&e.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(e.substring(4,i)),e=e.substring(i+3),s=!1)):m.test(e)?(i=e.match(m))&&(e=e.replace(i[0],""),s=!1):f.test(e)?(i=e.match(h))&&(e=e.substring(i[0].length),i[0].replace(h,a),s=!1):d.test(e)&&(i=e.match(l))&&(e=e.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=e.indexOf("<"),s=0>i?e:e.substring(0,i),e=0>i?"":e.substring(i),n.chars&&n.chars(o(s)))),e==v)throw u("badparse",e);v=e}a()}function o(e){if(!e)return"";var t=E.exec(e);e=t[1];var n=t[3];return(t=t[2])&&(D.innerHTML=t.replace(/</g,"&lt;"),t="textContent"in D?D.textContent:D.innerText),e+t+n}function s(e){return e.replace(/&/g,"&amp;").replace(v,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,n){var r=!1,a=t.bind(e,e.push);return{start:function(e,i,o){e=t.lowercase(e),!r&&S[e]&&(r=e),r||!0!==y[e]||(a("<"),a(e),t.forEach(i,function(r,i){var o=t.lowercase(i),c="img"===e&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(e){e=t.lowercase(e),r||!0!==y[e]||(a("</"),a(e),a(">")),e==r&&(r=!1)},chars:function(e){r||a(s(e))}}}var u=t.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,p=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,d=/^</,f=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");e=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=t.extend({},n,e),x=t.extend({},e,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=t.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),S=a("script,style"),y=t.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=t.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(e){return function(t){var n=[];return i(t,c(n,function(t,n){return!/^unsafe/.test(e(t,n))})),n.join("")}}]}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(e){e&&d.push(r(e))}function c(e,n){d.push("<a "),t.isDefined(o)&&(d.push('target="'),d.push(o),d.push('" ')),d.push('href="'),d.push(e),d.push('">'),s(n),d.push("</a>")}if(!i)return i;for(var u,l,h,p=i,d=[];u=p.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(p.substr(0,h)),c(l,u[0].replace(a,"")),p=p.substring(h+u[0].length);return s(p),e(d.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(e,t){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(t,r){null!=n?r(n):e({url:t+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(e){n=e.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(e){alert("Cannot get digestValue.")})},getFileBuffer:function(e){var n=t.defer(),r=new FileReader;return r.onload=function(e){n.resolve(e.target.result)},r.onerror=function(e){n.reject(e.target.error)},r.readAsArrayBuffer(e),n.promise},addListFileAttachment:function(t,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(t,function(a){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(e){return e},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(e){o(e)},function(e){s(e)})})})},deleteListFileAttachment:function(t,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(t,function(s){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(e){i(e)},function(e){o(e)})})},getListItemType:function(e){return("SP.Data."+e[0].toUpperCase()+e.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(t,n,r,a,i,o){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){i(e)},function(e){o(e);

})},getListItems:function(t,n,r,a,i){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){a(e)},function(e){i(e)})},addListItem:function(t,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(t,function(r){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(e){a(e)},function(e){i(e)})})},updateListItem:function(t,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(t,function(a){c(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":t.data.d.__metadata.etag}}).then(function(e){i(e)},function(e){o(e)})},function(e){o(e)})})},deleteListItem:function(t,n,r,a,i){var o=this.getListItem;this.getDigestValue(t,function(s){o(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":t.data.d.__metadata.etag}}).then(function(e){a(e)},function(e){i(e)})},function(e){i(e)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(e){return{$$silentChangePath:!1,silent:function(t,n){this.prev=e.path();var r=e.url(t);n&&r.replace(),this.$$silentChangePath=e.path()},box:function(e,t){t[e].__silentModeMarker||!function(){var n=t[e];t[e]=function(){t[e]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(e,t,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===t.path())for(var i in e.$$listeners.$locationChangeSuccess)n.box(i,e.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,e.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function e(e,t){var n=i.indexOf(e.charAt(t));if(-1==n)throw"Cannot decode base64";return n}function t(t){t=""+t;var n,r,i,o=t.length;if(0==o)return t;if(0!=o%4)throw"Cannot decode base64";n=0,t.charAt(o-1)==a&&(n=1,t.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6|e(t,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=e(t,r)<<18|e(t,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(e,t){var n=e.charCodeAt(t);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(e){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var t,r,o=[];e=""+e;var s=e.length-e.length%3;if(0==e.length)return e;for(t=0;s>t;t+=3)r=n(e,t)<<16|n(e,t+1)<<8|n(e,t+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(e.length-s){case 1:r=n(e,t)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(e,t)<<16|n(e,t+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:t}}())}(),function(e,t,n){"use strict";function r(){function e(e,n){return t.extend(new(t.extend(function(){},{prototype:e})),n)}function n(e,t){var n=t.caseInsensitiveMatch,r={originalPath:e,regexp:e},a=r.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(e,t,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),t=t||"",""+(i?"":t)+"(?:"+(i?t:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+e+"$",n?"i":""),r}var r={};this.when=function(e,a){if(r[e]=t.extend({reloadOnSearch:!0},a,e&&n(e,a)),e){var i="/"==e[e.length-1]?e.substr(0,e.length-1):e+"/";r[i]=t.extend({redirectTo:e},n(i,a))}return this},this.otherwise=function(e){return this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(e,t){var n=t.keys,r={};if(!t.regexp)return null;var a=t.regexp.exec(e);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function p(){var e=d(),r=m.current;e&&r&&e.$$route===r.$$route&&t.equals(e.pathParams,r.pathParams)&&!e.reloadOnSearch&&!g?(r.params=e.params,t.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(e||r)&&(g=!1,n.$broadcast("$routeChangeStart",e,r),m.current=e,e&&e.redirectTo&&(t.isString(e.redirectTo)?a.path(f(e.redirectTo,e.params)).search(e.params).replace():a.url(e.redirectTo(e.pathParams,a.path(),a.search())).replace()),o.when(e).then(function(){if(e){var n,r,a=t.extend({},e.resolve);return t.forEach(a,function(e,n){a[n]=t.isString(e)?s.get(e):s.invoke(e)}),t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(r=e.templateUrl)&&(t.isFunction(r)&&(r=r(e.params)),r=l.getTrustedResourceUrl(r),t.isDefined(r)&&(e.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(e){return e.data}))),t.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){e==m.current&&(e&&(e.locals=a,t.copy(e.params,i)),n.$broadcast("$routeChangeSuccess",e,r))},function(t){e==m.current&&n.$broadcast("$routeChangeError",e,r,t)}))}function d(){var n,i;return t.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=e(r,{params:t.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&e(r[null],{params:{},pathParams:{}})}function f(e,n){var r=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)r.push(e);else{var a=e.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(p)}};return n.$on("$locationChangeSuccess",p),m}]}function a(){this.$get=function(){return{}}}function i(e,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),p&&(r.leave(p),p=null)}function l(){var o=e.current&&e.current.locals,s=o&&o.$template;if(t.isDefined(s)){var l=a.$new(),g=e.current,m=c(l,function(e){r.enter(e,null,p||i,function(){!t.isDefined(d)||d&&!a.$eval(d)||n()}),u()});p=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(f)}else u()}var h,p,d=o.autoscroll,f=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(e,t,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=e(a.contents());if(i.controller){o.$scope=r;var c=t(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=t.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(e,t,n){"use strict";function r(e){var n=[];return c(n,t.noop).chars(e),n.join("")}function a(e){var t={};e=e.split(",");var n;for(n=0;n<e.length;n++)t[e[n]]=!0;return t}function i(e,n){function r(e,r,i,s){if(r=t.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(p,function(e,t,n,r,a){u[t]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(e,r){var a,i=0;if(r=t.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=e;for(c.last=function(){return c[c.length-1]};e;){if(s=!0,c.last()&&S[c.last()]?(e=e.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(e,t){return t=t.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(t)),""}),a("",c.last())):(0===e.indexOf("<!--")?(i=e.indexOf("--",4),i>=0&&e.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(e.substring(4,i)),e=e.substring(i+3),s=!1)):m.test(e)?(i=e.match(m))&&(e=e.replace(i[0],""),s=!1):f.test(e)?(i=e.match(h))&&(e=e.substring(i[0].length),i[0].replace(h,a),s=!1):d.test(e)&&(i=e.match(l))&&(e=e.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=e.indexOf("<"),s=0>i?e:e.substring(0,i),e=0>i?"":e.substring(i),n.chars&&n.chars(o(s)))),e==v)throw u("badparse",e);v=e}a()}function o(e){if(!e)return"";var t=E.exec(e);e=t[1];var n=t[3];return(t=t[2])&&(D.innerHTML=t.replace(/</g,"&lt;"),t="textContent"in D?D.textContent:D.innerText),e+t+n}function s(e){return e.replace(/&/g,"&amp;").replace(v,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,n){var r=!1,a=t.bind(e,e.push);return{start:function(e,i,o){e=t.lowercase(e),!r&&S[e]&&(r=e),r||!0!==y[e]||(a("<"),a(e),t.forEach(i,function(r,i){var o=t.lowercase(i),c="img"===e&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(e){e=t.lowercase(e),r||!0!==y[e]||(a("</"),a(e),a(">")),e==r&&(r=!1)},chars:function(e){r||a(s(e))}}}var u=t.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,p=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,d=/^</,f=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");e=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=t.extend({},n,e),x=t.extend({},e,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=t.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),S=a("script,style"),y=t.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=t.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(e){return function(t){var n=[];return i(t,c(n,function(t,n){return!/^unsafe/.test(e(t,n))})),n.join("")}}]}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(e){e&&d.push(r(e))}function c(e,n){d.push("<a "),t.isDefined(o)&&(d.push('target="'),d.push(o),d.push('" ')),d.push('href="'),d.push(e),d.push('">'),s(n),d.push("</a>")}if(!i)return i;for(var u,l,h,p=i,d=[];u=p.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(p.substr(0,h)),c(l,u[0].replace(a,"")),p=p.substring(h+u[0].length);return s(p),e(d.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(e,t){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(t,r){null!=n?r(n):e({url:t+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(e){n=e.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(e){alert("Cannot get digestValue.")})},getFileBuffer:function(e){var n=t.defer(),r=new FileReader;return r.onload=function(e){n.resolve(e.target.result)},r.onerror=function(e){n.reject(e.target.error)},r.readAsArrayBuffer(e),n.promise},addListFileAttachment:function(t,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(t,function(a){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(e){return e},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(e){o(e)},function(e){s(e)})})})},deleteListFileAttachment:function(t,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(t,function(s){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(e){i(e)},function(e){o(e)})})},getListItemType:function(e){return("SP.Data."+e[0].toUpperCase()+e.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(t,n,r,a,i,o){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){i(e)},function(e){o(e)})},getListItems:function(t,n,r,a,i){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){a(e)},function(e){i(e)})},addListItem:function(t,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(t,function(r){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(e){a(e)},function(e){i(e)})})},updateListItem:function(t,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(t,function(a){c(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":t.data.d.__metadata.etag}}).then(function(e){i(e)},function(e){o(e)})},function(e){o(e)})})},deleteListItem:function(t,n,r,a,i){var o=this.getListItem;this.getDigestValue(t,function(s){o(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":t.data.d.__metadata.etag}}).then(function(e){a(e)},function(e){i(e)})},function(e){i(e)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(e){return{$$silentChangePath:!1,silent:function(t,n){this.prev=e.path();var r=e.url(t);n&&r.replace(),this.$$silentChangePath=e.path()},box:function(e,t){t[e].__silentModeMarker||!function(){var n=t[e];t[e]=function(){t[e]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(e,t,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===t.path())for(var i in e.$$listeners.$locationChangeSuccess)n.box(i,e.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,e.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function e(e,t){var n=i.indexOf(e.charAt(t));if(-1==n)throw"Cannot decode base64";return n}function t(t){t=""+t;var n,r,i,o=t.length;if(0==o)return t;if(0!=o%4)throw"Cannot decode base64";n=0,t.charAt(o-1)==a&&(n=1,t.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6|e(t,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=e(t,r)<<18|e(t,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(e,t){var n=e.charCodeAt(t);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(e){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var t,r,o=[];e=""+e;var s=e.length-e.length%3;if(0==e.length)return e;for(t=0;s>t;t+=3)r=n(e,t)<<16|n(e,t+1)<<8|n(e,t+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(e.length-s){case 1:r=n(e,t)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(e,t)<<16|n(e,t+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:t}}())}(),function(e,t,n){"use strict";function r(){function e(e,n){return t.extend(new(t.extend(function(){},{prototype:e})),n)}function n(e,t){var n=t.caseInsensitiveMatch,r={originalPath:e,regexp:e},a=r.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(e,t,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),t=t||"",""+(i?"":t)+"(?:"+(i?t:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+e+"$",n?"i":""),r}var r={};this.when=function(e,a){if(r[e]=t.extend({reloadOnSearch:!0},a,e&&n(e,a)),e){var i="/"==e[e.length-1]?e.substr(0,e.length-1):e+"/";r[i]=t.extend({redirectTo:e},n(i,a))}return this},this.otherwise=function(e){return this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(e,t){var n=t.keys,r={};if(!t.regexp)return null;var a=t.regexp.exec(e);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function p(){var e=d(),r=m.current;e&&r&&e.$$route===r.$$route&&t.equals(e.pathParams,r.pathParams)&&!e.reloadOnSearch&&!g?(r.params=e.params,t.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(e||r)&&(g=!1,n.$broadcast("$routeChangeStart",e,r),m.current=e,e&&e.redirectTo&&(t.isString(e.redirectTo)?a.path(f(e.redirectTo,e.params)).search(e.params).replace():a.url(e.redirectTo(e.pathParams,a.path(),a.search())).replace()),o.when(e).then(function(){if(e){var n,r,a=t.extend({},e.resolve);return t.forEach(a,function(e,n){a[n]=t.isString(e)?s.get(e):s.invoke(e)}),t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(r=e.templateUrl)&&(t.isFunction(r)&&(r=r(e.params)),r=l.getTrustedResourceUrl(r),t.isDefined(r)&&(e.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(e){return e.data}))),t.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){e==m.current&&(e&&(e.locals=a,t.copy(e.params,i)),n.$broadcast("$routeChangeSuccess",e,r))},function(t){e==m.current&&n.$broadcast("$routeChangeError",e,r,t)}))}function d(){var n,i;return t.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=e(r,{params:t.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&e(r[null],{params:{},pathParams:{}})}function f(e,n){var r=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)r.push(e);else{var a=e.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(p)}};return n.$on("$locationChangeSuccess",p),m}]}function a(){this.$get=function(){return{}}}function i(e,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),p&&(r.leave(p),p=null)}function l(){var o=e.current&&e.current.locals,s=o&&o.$template;if(t.isDefined(s)){var l=a.$new(),g=e.current,m=c(l,function(e){r.enter(e,null,p||i,function(){!t.isDefined(d)||d&&!a.$eval(d)||n()}),u()});p=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(f)}else u()}var h,p,d=o.autoscroll,f=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(e,t,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=e(a.contents());if(i.controller){o.$scope=r;var c=t(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=t.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(e,t,n){"use strict";function r(e){var n=[];return c(n,t.noop).chars(e),n.join("")}function a(e){var t={};e=e.split(",");var n;for(n=0;n<e.length;n++)t[e[n]]=!0;return t}function i(e,n){function r(e,r,i,s){if(r=t.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(p,function(e,t,n,r,a){u[t]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(e,r){var a,i=0;if(r=t.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=e;for(c.last=function(){return c[c.length-1]};e;){if(s=!0,c.last()&&S[c.last()]?(e=e.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(e,t){return t=t.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(t)),""}),a("",c.last())):(0===e.indexOf("<!--")?(i=e.indexOf("--",4),i>=0&&e.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(e.substring(4,i)),e=e.substring(i+3),s=!1)):m.test(e)?(i=e.match(m))&&(e=e.replace(i[0],""),s=!1):f.test(e)?(i=e.match(h))&&(e=e.substring(i[0].length),i[0].replace(h,a),s=!1):d.test(e)&&(i=e.match(l))&&(e=e.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=e.indexOf("<"),s=0>i?e:e.substring(0,i),e=0>i?"":e.substring(i),n.chars&&n.chars(o(s)))),e==v)throw u("badparse",e);v=e}a()}function o(e){if(!e)return"";var t=E.exec(e);e=t[1];var n=t[3];return(t=t[2])&&(D.innerHTML=t.replace(/</g,"&lt;"),t="textContent"in D?D.textContent:D.innerText),e+t+n}function s(e){return e.replace(/&/g,"&amp;").replace(v,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,n){var r=!1,a=t.bind(e,e.push);return{start:function(e,i,o){e=t.lowercase(e),!r&&S[e]&&(r=e),r||!0!==y[e]||(a("<"),a(e),t.forEach(i,function(r,i){var o=t.lowercase(i),c="img"===e&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(e){e=t.lowercase(e),r||!0!==y[e]||(a("</"),a(e),a(">")),e==r&&(r=!1)},chars:function(e){r||a(s(e))}}}var u=t.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,p=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,d=/^</,f=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");e=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=t.extend({},n,e),x=t.extend({},e,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=t.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),S=a("script,style"),y=t.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=t.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(e){return function(t){var n=[];return i(t,c(n,function(t,n){return!/^unsafe/.test(e(t,n))})),n.join("")}}]}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(e){e&&d.push(r(e))}function c(e,n){d.push("<a "),t.isDefined(o)&&(d.push('target="'),d.push(o),d.push('" ')),d.push('href="'),d.push(e),d.push('">'),s(n),d.push("</a>")}if(!i)return i;for(var u,l,h,p=i,d=[];u=p.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(p.substr(0,h)),c(l,u[0].replace(a,"")),p=p.substring(h+u[0].length);return s(p),e(d.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(e,t){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(t,r){null!=n?r(n):e({url:t+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(e){n=e.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(e){alert("Cannot get digestValue.")})},getFileBuffer:function(e){var n=t.defer(),r=new FileReader;return r.onload=function(e){n.resolve(e.target.result)},r.onerror=function(e){n.reject(e.target.error)},r.readAsArrayBuffer(e),n.promise},addListFileAttachment:function(t,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(t,function(a){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(e){return e},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(e){o(e)},function(e){s(e)})})})},deleteListFileAttachment:function(t,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(t,function(s){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(e){i(e)},function(e){o(e)})})},getListItemType:function(e){return("SP.Data."+e[0].toUpperCase()+e.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(t,n,r,a,i,o){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){i(e)},function(e){o(e)})},getListItems:function(t,n,r,a,i){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){a(e)},function(e){i(e)})},addListItem:function(t,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(t,function(r){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(e){a(e)},function(e){i(e)})})},updateListItem:function(t,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(t,function(a){c(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":t.data.d.__metadata.etag}}).then(function(e){i(e)},function(e){o(e)})},function(e){o(e)})})},deleteListItem:function(t,n,r,a,i){var o=this.getListItem;this.getDigestValue(t,function(s){o(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":t.data.d.__metadata.etag}}).then(function(e){a(e)},function(e){i(e)})},function(e){i(e)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(e){return{$$silentChangePath:!1,silent:function(t,n){this.prev=e.path();var r=e.url(t);n&&r.replace(),this.$$silentChangePath=e.path()},box:function(e,t){t[e].__silentModeMarker||!function(){var n=t[e];t[e]=function(){t[e]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(e,t,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===t.path())for(var i in e.$$listeners.$locationChangeSuccess)n.box(i,e.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,e.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function e(e,t){var n=i.indexOf(e.charAt(t));if(-1==n)throw"Cannot decode base64";return n}function t(t){t=""+t;var n,r,i,o=t.length;if(0==o)return t;if(0!=o%4)throw"Cannot decode base64";n=0,t.charAt(o-1)==a&&(n=1,t.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6|e(t,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=e(t,r)<<18|e(t,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(e,t){var n=e.charCodeAt(t);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(e){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var t,r,o=[];e=""+e;var s=e.length-e.length%3;if(0==e.length)return e;for(t=0;s>t;t+=3)r=n(e,t)<<16|n(e,t+1)<<8|n(e,t+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(e.length-s){case 1:r=n(e,t)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(e,t)<<16|n(e,t+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:t}}())}(),function(e,t,n){"use strict";function r(){function e(e,n){return t.extend(new(t.extend(function(){},{prototype:e})),n)}function n(e,t){var n=t.caseInsensitiveMatch,r={originalPath:e,regexp:e},a=r.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(e,t,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),t=t||"",""+(i?"":t)+"(?:"+(i?t:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+e+"$",n?"i":""),r}var r={};this.when=function(e,a){if(r[e]=t.extend({reloadOnSearch:!0},a,e&&n(e,a)),e){var i="/"==e[e.length-1]?e.substr(0,e.length-1):e+"/";r[i]=t.extend({redirectTo:e},n(i,a))}return this},this.otherwise=function(e){return this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(e,t){var n=t.keys,r={};if(!t.regexp)return null;var a=t.regexp.exec(e);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function p(){var e=d(),r=m.current;e&&r&&e.$$route===r.$$route&&t.equals(e.pathParams,r.pathParams)&&!e.reloadOnSearch&&!g?(r.params=e.params,t.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(e||r)&&(g=!1,n.$broadcast("$routeChangeStart",e,r),m.current=e,e&&e.redirectTo&&(t.isString(e.redirectTo)?a.path(f(e.redirectTo,e.params)).search(e.params).replace():a.url(e.redirectTo(e.pathParams,a.path(),a.search())).replace()),o.when(e).then(function(){if(e){var n,r,a=t.extend({},e.resolve);return t.forEach(a,function(e,n){a[n]=t.isString(e)?s.get(e):s.invoke(e)}),t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(r=e.templateUrl)&&(t.isFunction(r)&&(r=r(e.params)),r=l.getTrustedResourceUrl(r),t.isDefined(r)&&(e.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(e){return e.data}))),t.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){e==m.current&&(e&&(e.locals=a,t.copy(e.params,i)),n.$broadcast("$routeChangeSuccess",e,r))},function(t){e==m.current&&n.$broadcast("$routeChangeError",e,r,t);

}))}function d(){var n,i;return t.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=e(r,{params:t.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&e(r[null],{params:{},pathParams:{}})}function f(e,n){var r=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)r.push(e);else{var a=e.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(p)}};return n.$on("$locationChangeSuccess",p),m}]}function a(){this.$get=function(){return{}}}function i(e,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),p&&(r.leave(p),p=null)}function l(){var o=e.current&&e.current.locals,s=o&&o.$template;if(t.isDefined(s)){var l=a.$new(),g=e.current,m=c(l,function(e){r.enter(e,null,p||i,function(){!t.isDefined(d)||d&&!a.$eval(d)||n()}),u()});p=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(f)}else u()}var h,p,d=o.autoscroll,f=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(e,t,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=e(a.contents());if(i.controller){o.$scope=r;var c=t(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=t.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(e,t,n){"use strict";function r(e){var n=[];return c(n,t.noop).chars(e),n.join("")}function a(e){var t={};e=e.split(",");var n;for(n=0;n<e.length;n++)t[e[n]]=!0;return t}function i(e,n){function r(e,r,i,s){if(r=t.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(p,function(e,t,n,r,a){u[t]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(e,r){var a,i=0;if(r=t.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=e;for(c.last=function(){return c[c.length-1]};e;){if(s=!0,c.last()&&S[c.last()]?(e=e.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(e,t){return t=t.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(t)),""}),a("",c.last())):(0===e.indexOf("<!--")?(i=e.indexOf("--",4),i>=0&&e.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(e.substring(4,i)),e=e.substring(i+3),s=!1)):m.test(e)?(i=e.match(m))&&(e=e.replace(i[0],""),s=!1):f.test(e)?(i=e.match(h))&&(e=e.substring(i[0].length),i[0].replace(h,a),s=!1):d.test(e)&&(i=e.match(l))&&(e=e.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=e.indexOf("<"),s=0>i?e:e.substring(0,i),e=0>i?"":e.substring(i),n.chars&&n.chars(o(s)))),e==v)throw u("badparse",e);v=e}a()}function o(e){if(!e)return"";var t=E.exec(e);e=t[1];var n=t[3];return(t=t[2])&&(D.innerHTML=t.replace(/</g,"&lt;"),t="textContent"in D?D.textContent:D.innerText),e+t+n}function s(e){return e.replace(/&/g,"&amp;").replace(v,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,n){var r=!1,a=t.bind(e,e.push);return{start:function(e,i,o){e=t.lowercase(e),!r&&S[e]&&(r=e),r||!0!==y[e]||(a("<"),a(e),t.forEach(i,function(r,i){var o=t.lowercase(i),c="img"===e&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(e){e=t.lowercase(e),r||!0!==y[e]||(a("</"),a(e),a(">")),e==r&&(r=!1)},chars:function(e){r||a(s(e))}}}var u=t.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,p=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,d=/^</,f=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");e=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=t.extend({},n,e),x=t.extend({},e,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=t.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),S=a("script,style"),y=t.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=t.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(e){return function(t){var n=[];return i(t,c(n,function(t,n){return!/^unsafe/.test(e(t,n))})),n.join("")}}]}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(e){e&&d.push(r(e))}function c(e,n){d.push("<a "),t.isDefined(o)&&(d.push('target="'),d.push(o),d.push('" ')),d.push('href="'),d.push(e),d.push('">'),s(n),d.push("</a>")}if(!i)return i;for(var u,l,h,p=i,d=[];u=p.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(p.substr(0,h)),c(l,u[0].replace(a,"")),p=p.substring(h+u[0].length);return s(p),e(d.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(e,t){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(t,r){null!=n?r(n):e({url:t+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(e){n=e.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(e){alert("Cannot get digestValue.")})},getFileBuffer:function(e){var n=t.defer(),r=new FileReader;return r.onload=function(e){n.resolve(e.target.result)},r.onerror=function(e){n.reject(e.target.error)},r.readAsArrayBuffer(e),n.promise},addListFileAttachment:function(t,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(t,function(a){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(e){return e},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(e){o(e)},function(e){s(e)})})})},deleteListFileAttachment:function(t,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(t,function(s){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(e){i(e)},function(e){o(e)})})},getListItemType:function(e){return("SP.Data."+e[0].toUpperCase()+e.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(t,n,r,a,i,o){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){i(e)},function(e){o(e)})},getListItems:function(t,n,r,a,i){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){a(e)},function(e){i(e)})},addListItem:function(t,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(t,function(r){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(e){a(e)},function(e){i(e)})})},updateListItem:function(t,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(t,function(a){c(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":t.data.d.__metadata.etag}}).then(function(e){i(e)},function(e){o(e)})},function(e){o(e)})})},deleteListItem:function(t,n,r,a,i){var o=this.getListItem;this.getDigestValue(t,function(s){o(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":t.data.d.__metadata.etag}}).then(function(e){a(e)},function(e){i(e)})},function(e){i(e)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(e){return{$$silentChangePath:!1,silent:function(t,n){this.prev=e.path();var r=e.url(t);n&&r.replace(),this.$$silentChangePath=e.path()},box:function(e,t){t[e].__silentModeMarker||!function(){var n=t[e];t[e]=function(){t[e]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(e,t,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===t.path())for(var i in e.$$listeners.$locationChangeSuccess)n.box(i,e.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,e.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function e(e,t){var n=i.indexOf(e.charAt(t));if(-1==n)throw"Cannot decode base64";return n}function t(t){t=""+t;var n,r,i,o=t.length;if(0==o)return t;if(0!=o%4)throw"Cannot decode base64";n=0,t.charAt(o-1)==a&&(n=1,t.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6|e(t,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=e(t,r)<<18|e(t,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(e,t){var n=e.charCodeAt(t);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(e){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var t,r,o=[];e=""+e;var s=e.length-e.length%3;if(0==e.length)return e;for(t=0;s>t;t+=3)r=n(e,t)<<16|n(e,t+1)<<8|n(e,t+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(e.length-s){case 1:r=n(e,t)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(e,t)<<16|n(e,t+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:t}}())}(),function(e,t,n){"use strict";function r(){function e(e,n){return t.extend(new(t.extend(function(){},{prototype:e})),n)}function n(e,t){var n=t.caseInsensitiveMatch,r={originalPath:e,regexp:e},a=r.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(e,t,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),t=t||"",""+(i?"":t)+"(?:"+(i?t:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+e+"$",n?"i":""),r}var r={};this.when=function(e,a){if(r[e]=t.extend({reloadOnSearch:!0},a,e&&n(e,a)),e){var i="/"==e[e.length-1]?e.substr(0,e.length-1):e+"/";r[i]=t.extend({redirectTo:e},n(i,a))}return this},this.otherwise=function(e){return this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(e,t){var n=t.keys,r={};if(!t.regexp)return null;var a=t.regexp.exec(e);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function p(){var e=d(),r=m.current;e&&r&&e.$$route===r.$$route&&t.equals(e.pathParams,r.pathParams)&&!e.reloadOnSearch&&!g?(r.params=e.params,t.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(e||r)&&(g=!1,n.$broadcast("$routeChangeStart",e,r),m.current=e,e&&e.redirectTo&&(t.isString(e.redirectTo)?a.path(f(e.redirectTo,e.params)).search(e.params).replace():a.url(e.redirectTo(e.pathParams,a.path(),a.search())).replace()),o.when(e).then(function(){if(e){var n,r,a=t.extend({},e.resolve);return t.forEach(a,function(e,n){a[n]=t.isString(e)?s.get(e):s.invoke(e)}),t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(r=e.templateUrl)&&(t.isFunction(r)&&(r=r(e.params)),r=l.getTrustedResourceUrl(r),t.isDefined(r)&&(e.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(e){return e.data}))),t.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){e==m.current&&(e&&(e.locals=a,t.copy(e.params,i)),n.$broadcast("$routeChangeSuccess",e,r))},function(t){e==m.current&&n.$broadcast("$routeChangeError",e,r,t)}))}function d(){var n,i;return t.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=e(r,{params:t.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&e(r[null],{params:{},pathParams:{}})}function f(e,n){var r=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)r.push(e);else{var a=e.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(p)}};return n.$on("$locationChangeSuccess",p),m}]}function a(){this.$get=function(){return{}}}function i(e,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),p&&(r.leave(p),p=null)}function l(){var o=e.current&&e.current.locals,s=o&&o.$template;if(t.isDefined(s)){var l=a.$new(),g=e.current,m=c(l,function(e){r.enter(e,null,p||i,function(){!t.isDefined(d)||d&&!a.$eval(d)||n()}),u()});p=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(f)}else u()}var h,p,d=o.autoscroll,f=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(e,t,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=e(a.contents());if(i.controller){o.$scope=r;var c=t(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=t.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(e,t,n){"use strict";function r(e){var n=[];return c(n,t.noop).chars(e),n.join("")}function a(e){var t={};e=e.split(",");var n;for(n=0;n<e.length;n++)t[e[n]]=!0;return t}function i(e,n){function r(e,r,i,s){if(r=t.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(p,function(e,t,n,r,a){u[t]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(e,r){var a,i=0;if(r=t.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=e;for(c.last=function(){return c[c.length-1]};e;){if(s=!0,c.last()&&S[c.last()]?(e=e.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(e,t){return t=t.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(t)),""}),a("",c.last())):(0===e.indexOf("<!--")?(i=e.indexOf("--",4),i>=0&&e.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(e.substring(4,i)),e=e.substring(i+3),s=!1)):m.test(e)?(i=e.match(m))&&(e=e.replace(i[0],""),s=!1):f.test(e)?(i=e.match(h))&&(e=e.substring(i[0].length),i[0].replace(h,a),s=!1):d.test(e)&&(i=e.match(l))&&(e=e.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=e.indexOf("<"),s=0>i?e:e.substring(0,i),e=0>i?"":e.substring(i),n.chars&&n.chars(o(s)))),e==v)throw u("badparse",e);v=e}a()}function o(e){if(!e)return"";var t=E.exec(e);e=t[1];var n=t[3];return(t=t[2])&&(D.innerHTML=t.replace(/</g,"&lt;"),t="textContent"in D?D.textContent:D.innerText),e+t+n}function s(e){return e.replace(/&/g,"&amp;").replace(v,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,n){var r=!1,a=t.bind(e,e.push);return{start:function(e,i,o){e=t.lowercase(e),!r&&S[e]&&(r=e),r||!0!==y[e]||(a("<"),a(e),t.forEach(i,function(r,i){var o=t.lowercase(i),c="img"===e&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(e){e=t.lowercase(e),r||!0!==y[e]||(a("</"),a(e),a(">")),e==r&&(r=!1)},chars:function(e){r||a(s(e))}}}var u=t.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,p=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,d=/^</,f=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");e=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=t.extend({},n,e),x=t.extend({},e,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=t.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),S=a("script,style"),y=t.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=t.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(e){return function(t){var n=[];return i(t,c(n,function(t,n){return!/^unsafe/.test(e(t,n))})),n.join("")}}]}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(e){e&&d.push(r(e))}function c(e,n){d.push("<a "),t.isDefined(o)&&(d.push('target="'),d.push(o),d.push('" ')),d.push('href="'),d.push(e),d.push('">'),s(n),d.push("</a>")}if(!i)return i;for(var u,l,h,p=i,d=[];u=p.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(p.substr(0,h)),c(l,u[0].replace(a,"")),p=p.substring(h+u[0].length);return s(p),e(d.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(e,t){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(t,r){null!=n?r(n):e({url:t+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(e){n=e.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(e){alert("Cannot get digestValue.")})},getFileBuffer:function(e){var n=t.defer(),r=new FileReader;return r.onload=function(e){n.resolve(e.target.result)},r.onerror=function(e){n.reject(e.target.error)},r.readAsArrayBuffer(e),n.promise},addListFileAttachment:function(t,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(t,function(a){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(e){return e},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(e){o(e)},function(e){s(e)})})})},deleteListFileAttachment:function(t,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(t,function(s){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(e){i(e)},function(e){o(e)})})},getListItemType:function(e){return("SP.Data."+e[0].toUpperCase()+e.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(t,n,r,a,i,o){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){i(e)},function(e){o(e)})},getListItems:function(t,n,r,a,i){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){a(e)},function(e){i(e)})},addListItem:function(t,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(t,function(r){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(e){a(e)},function(e){i(e)})})},updateListItem:function(t,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(t,function(a){c(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":t.data.d.__metadata.etag}}).then(function(e){i(e)},function(e){o(e)})},function(e){o(e)})})},deleteListItem:function(t,n,r,a,i){var o=this.getListItem;this.getDigestValue(t,function(s){o(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":t.data.d.__metadata.etag}}).then(function(e){a(e)},function(e){i(e)})},function(e){i(e)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(e){return{$$silentChangePath:!1,silent:function(t,n){this.prev=e.path();var r=e.url(t);n&&r.replace(),this.$$silentChangePath=e.path()},box:function(e,t){t[e].__silentModeMarker||!function(){var n=t[e];t[e]=function(){t[e]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(e,t,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===t.path())for(var i in e.$$listeners.$locationChangeSuccess)n.box(i,e.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,e.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function e(e,t){var n=i.indexOf(e.charAt(t));if(-1==n)throw"Cannot decode base64";return n}function t(t){t=""+t;var n,r,i,o=t.length;if(0==o)return t;if(0!=o%4)throw"Cannot decode base64";n=0,t.charAt(o-1)==a&&(n=1,t.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6|e(t,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=e(t,r)<<18|e(t,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(e,t){var n=e.charCodeAt(t);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(e){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var t,r,o=[];e=""+e;var s=e.length-e.length%3;if(0==e.length)return e;for(t=0;s>t;t+=3)r=n(e,t)<<16|n(e,t+1)<<8|n(e,t+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(e.length-s){case 1:r=n(e,t)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(e,t)<<16|n(e,t+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:t}}())}(),function(e,t,n){"use strict";function r(){function e(e,n){return t.extend(new(t.extend(function(){},{prototype:e})),n)}function n(e,t){var n=t.caseInsensitiveMatch,r={originalPath:e,regexp:e},a=r.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(e,t,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),t=t||"",""+(i?"":t)+"(?:"+(i?t:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+e+"$",n?"i":""),r}var r={};this.when=function(e,a){if(r[e]=t.extend({reloadOnSearch:!0},a,e&&n(e,a)),e){var i="/"==e[e.length-1]?e.substr(0,e.length-1):e+"/";r[i]=t.extend({redirectTo:e},n(i,a))}return this},this.otherwise=function(e){return this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(e,t){var n=t.keys,r={};if(!t.regexp)return null;var a=t.regexp.exec(e);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function p(){var e=d(),r=m.current;e&&r&&e.$$route===r.$$route&&t.equals(e.pathParams,r.pathParams)&&!e.reloadOnSearch&&!g?(r.params=e.params,t.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(e||r)&&(g=!1,n.$broadcast("$routeChangeStart",e,r),m.current=e,e&&e.redirectTo&&(t.isString(e.redirectTo)?a.path(f(e.redirectTo,e.params)).search(e.params).replace():a.url(e.redirectTo(e.pathParams,a.path(),a.search())).replace()),o.when(e).then(function(){if(e){var n,r,a=t.extend({},e.resolve);return t.forEach(a,function(e,n){a[n]=t.isString(e)?s.get(e):s.invoke(e)}),t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(r=e.templateUrl)&&(t.isFunction(r)&&(r=r(e.params)),r=l.getTrustedResourceUrl(r),t.isDefined(r)&&(e.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(e){return e.data}))),t.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){e==m.current&&(e&&(e.locals=a,t.copy(e.params,i)),n.$broadcast("$routeChangeSuccess",e,r))},function(t){e==m.current&&n.$broadcast("$routeChangeError",e,r,t)}))}function d(){var n,i;return t.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=e(r,{params:t.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&e(r[null],{params:{},pathParams:{}})}function f(e,n){var r=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)r.push(e);else{var a=e.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(p)}};return n.$on("$locationChangeSuccess",p),m}]}function a(){this.$get=function(){return{}}}function i(e,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),p&&(r.leave(p),p=null)}function l(){var o=e.current&&e.current.locals,s=o&&o.$template;if(t.isDefined(s)){var l=a.$new(),g=e.current,m=c(l,function(e){r.enter(e,null,p||i,function(){!t.isDefined(d)||d&&!a.$eval(d)||n()}),u()});p=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(f)}else u()}var h,p,d=o.autoscroll,f=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(e,t,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=e(a.contents());if(i.controller){o.$scope=r;var c=t(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=t.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(e,t,n){"use strict";function r(e){var n=[];return c(n,t.noop).chars(e),n.join("")}function a(e){var t={};e=e.split(",");var n;for(n=0;n<e.length;n++)t[e[n]]=!0;return t}function i(e,n){function r(e,r,i,s){if(r=t.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(p,function(e,t,n,r,a){u[t]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(e,r){var a,i=0;if(r=t.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=e;for(c.last=function(){return c[c.length-1]};e;){if(s=!0,c.last()&&S[c.last()]?(e=e.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(e,t){return t=t.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(t)),""}),a("",c.last())):(0===e.indexOf("<!--")?(i=e.indexOf("--",4),i>=0&&e.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(e.substring(4,i)),e=e.substring(i+3),s=!1)):m.test(e)?(i=e.match(m))&&(e=e.replace(i[0],""),s=!1):f.test(e)?(i=e.match(h))&&(e=e.substring(i[0].length),i[0].replace(h,a),s=!1):d.test(e)&&(i=e.match(l))&&(e=e.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=e.indexOf("<"),s=0>i?e:e.substring(0,i),e=0>i?"":e.substring(i),n.chars&&n.chars(o(s)))),e==v)throw u("badparse",e);v=e}a()}function o(e){if(!e)return"";var t=E.exec(e);e=t[1];var n=t[3];return(t=t[2])&&(D.innerHTML=t.replace(/</g,"&lt;"),t="textContent"in D?D.textContent:D.innerText),e+t+n}function s(e){return e.replace(/&/g,"&amp;").replace(v,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,n){var r=!1,a=t.bind(e,e.push);return{start:function(e,i,o){e=t.lowercase(e),!r&&S[e]&&(r=e),r||!0!==y[e]||(a("<"),a(e),t.forEach(i,function(r,i){var o=t.lowercase(i),c="img"===e&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(e){e=t.lowercase(e),r||!0!==y[e]||(a("</"),a(e),a(">")),e==r&&(r=!1)},chars:function(e){r||a(s(e))}}}var u=t.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,p=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,d=/^</,f=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");e=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=t.extend({},n,e),x=t.extend({},e,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=t.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),S=a("script,style"),y=t.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=t.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(e){return function(t){var n=[];return i(t,c(n,function(t,n){return!/^unsafe/.test(e(t,n))})),n.join("")}}]}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(e){e&&d.push(r(e))}function c(e,n){d.push("<a "),t.isDefined(o)&&(d.push('target="'),d.push(o),d.push('" ')),d.push('href="'),d.push(e),d.push('">'),s(n),d.push("</a>")}if(!i)return i;for(var u,l,h,p=i,d=[];u=p.match(n);)l=u[0],
u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(p.substr(0,h)),c(l,u[0].replace(a,"")),p=p.substring(h+u[0].length);return s(p),e(d.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(e,t){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(t,r){null!=n?r(n):e({url:t+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(e){n=e.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(e){alert("Cannot get digestValue.")})},getFileBuffer:function(e){var n=t.defer(),r=new FileReader;return r.onload=function(e){n.resolve(e.target.result)},r.onerror=function(e){n.reject(e.target.error)},r.readAsArrayBuffer(e),n.promise},addListFileAttachment:function(t,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(t,function(a){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(e){return e},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(e){o(e)},function(e){s(e)})})})},deleteListFileAttachment:function(t,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(t,function(s){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(e){i(e)},function(e){o(e)})})},getListItemType:function(e){return("SP.Data."+e[0].toUpperCase()+e.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(t,n,r,a,i,o){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){i(e)},function(e){o(e)})},getListItems:function(t,n,r,a,i){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){a(e)},function(e){i(e)})},addListItem:function(t,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(t,function(r){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(e){a(e)},function(e){i(e)})})},updateListItem:function(t,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(t,function(a){c(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":t.data.d.__metadata.etag}}).then(function(e){i(e)},function(e){o(e)})},function(e){o(e)})})},deleteListItem:function(t,n,r,a,i){var o=this.getListItem;this.getDigestValue(t,function(s){o(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":t.data.d.__metadata.etag}}).then(function(e){a(e)},function(e){i(e)})},function(e){i(e)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(e){return{$$silentChangePath:!1,silent:function(t,n){this.prev=e.path();var r=e.url(t);n&&r.replace(),this.$$silentChangePath=e.path()},box:function(e,t){t[e].__silentModeMarker||!function(){var n=t[e];t[e]=function(){t[e]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(e,t,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===t.path())for(var i in e.$$listeners.$locationChangeSuccess)n.box(i,e.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,e.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function e(e,t){var n=i.indexOf(e.charAt(t));if(-1==n)throw"Cannot decode base64";return n}function t(t){t=""+t;var n,r,i,o=t.length;if(0==o)return t;if(0!=o%4)throw"Cannot decode base64";n=0,t.charAt(o-1)==a&&(n=1,t.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6|e(t,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=e(t,r)<<18|e(t,r+1)<<12|e(t,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=e(t,r)<<18|e(t,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(e,t){var n=e.charCodeAt(t);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(e){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var t,r,o=[];e=""+e;var s=e.length-e.length%3;if(0==e.length)return e;for(t=0;s>t;t+=3)r=n(e,t)<<16|n(e,t+1)<<8|n(e,t+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(e.length-s){case 1:r=n(e,t)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(e,t)<<16|n(e,t+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:t}}())}(),function(e,t,n){"use strict";function r(){function e(e,n){return t.extend(new(t.extend(function(){},{prototype:e})),n)}function n(e,t){var n=t.caseInsensitiveMatch,r={originalPath:e,regexp:e},a=r.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(e,t,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),t=t||"",""+(i?"":t)+"(?:"+(i?t:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+e+"$",n?"i":""),r}var r={};this.when=function(e,a){if(r[e]=t.extend({reloadOnSearch:!0},a,e&&n(e,a)),e){var i="/"==e[e.length-1]?e.substr(0,e.length-1):e+"/";r[i]=t.extend({redirectTo:e},n(i,a))}return this},this.otherwise=function(e){return this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(e,t){var n=t.keys,r={};if(!t.regexp)return null;var a=t.regexp.exec(e);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function p(){var e=d(),r=m.current;e&&r&&e.$$route===r.$$route&&t.equals(e.pathParams,r.pathParams)&&!e.reloadOnSearch&&!g?(r.params=e.params,t.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(e||r)&&(g=!1,n.$broadcast("$routeChangeStart",e,r),m.current=e,e&&e.redirectTo&&(t.isString(e.redirectTo)?a.path(f(e.redirectTo,e.params)).search(e.params).replace():a.url(e.redirectTo(e.pathParams,a.path(),a.search())).replace()),o.when(e).then(function(){if(e){var n,r,a=t.extend({},e.resolve);return t.forEach(a,function(e,n){a[n]=t.isString(e)?s.get(e):s.invoke(e)}),t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(r=e.templateUrl)&&(t.isFunction(r)&&(r=r(e.params)),r=l.getTrustedResourceUrl(r),t.isDefined(r)&&(e.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(e){return e.data}))),t.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){e==m.current&&(e&&(e.locals=a,t.copy(e.params,i)),n.$broadcast("$routeChangeSuccess",e,r))},function(t){e==m.current&&n.$broadcast("$routeChangeError",e,r,t)}))}function d(){var n,i;return t.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=e(r,{params:t.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&e(r[null],{params:{},pathParams:{}})}function f(e,n){var r=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)r.push(e);else{var a=e.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(p)}};return n.$on("$locationChangeSuccess",p),m}]}function a(){this.$get=function(){return{}}}function i(e,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),p&&(r.leave(p),p=null)}function l(){var o=e.current&&e.current.locals,s=o&&o.$template;if(t.isDefined(s)){var l=a.$new(),g=e.current,m=c(l,function(e){r.enter(e,null,p||i,function(){!t.isDefined(d)||d&&!a.$eval(d)||n()}),u()});p=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(f)}else u()}var h,p,d=o.autoscroll,f=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(e,t,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=e(a.contents());if(i.controller){o.$scope=r;var c=t(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=t.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(e,t,n){"use strict";function r(e){var n=[];return c(n,t.noop).chars(e),n.join("")}function a(e){var t={};e=e.split(",");var n;for(n=0;n<e.length;n++)t[e[n]]=!0;return t}function i(e,n){function r(e,r,i,s){if(r=t.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(p,function(e,t,n,r,a){u[t]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(e,r){var a,i=0;if(r=t.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=e;for(c.last=function(){return c[c.length-1]};e;){if(s=!0,c.last()&&S[c.last()]?(e=e.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(e,t){return t=t.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(t)),""}),a("",c.last())):(0===e.indexOf("<!--")?(i=e.indexOf("--",4),i>=0&&e.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(e.substring(4,i)),e=e.substring(i+3),s=!1)):m.test(e)?(i=e.match(m))&&(e=e.replace(i[0],""),s=!1):f.test(e)?(i=e.match(h))&&(e=e.substring(i[0].length),i[0].replace(h,a),s=!1):d.test(e)&&(i=e.match(l))&&(e=e.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=e.indexOf("<"),s=0>i?e:e.substring(0,i),e=0>i?"":e.substring(i),n.chars&&n.chars(o(s)))),e==v)throw u("badparse",e);v=e}a()}function o(e){if(!e)return"";var t=E.exec(e);e=t[1];var n=t[3];return(t=t[2])&&(D.innerHTML=t.replace(/</g,"&lt;"),t="textContent"in D?D.textContent:D.innerText),e+t+n}function s(e){return e.replace(/&/g,"&amp;").replace(v,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,n){var r=!1,a=t.bind(e,e.push);return{start:function(e,i,o){e=t.lowercase(e),!r&&S[e]&&(r=e),r||!0!==y[e]||(a("<"),a(e),t.forEach(i,function(r,i){var o=t.lowercase(i),c="img"===e&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(e){e=t.lowercase(e),r||!0!==y[e]||(a("</"),a(e),a(">")),e==r&&(r=!1)},chars:function(e){r||a(s(e))}}}var u=t.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,p=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,d=/^</,f=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");e=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=t.extend({},n,e),x=t.extend({},e,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=t.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),S=a("script,style"),y=t.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=t.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(e){return function(t){var n=[];return i(t,c(n,function(t,n){return!/^unsafe/.test(e(t,n))})),n.join("")}}]}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(e){e&&d.push(r(e))}function c(e,n){d.push("<a "),t.isDefined(o)&&(d.push('target="'),d.push(o),d.push('" ')),d.push('href="'),d.push(e),d.push('">'),s(n),d.push("</a>")}if(!i)return i;for(var u,l,h,p=i,d=[];u=p.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(p.substr(0,h)),c(l,u[0].replace(a,"")),p=p.substring(h+u[0].length);return s(p),e(d.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(e,t){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(t,r){null!=n?r(n):e({url:t+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(e){n=e.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(e){alert("Cannot get digestValue.")})},getFileBuffer:function(e){var n=t.defer(),r=new FileReader;return r.onload=function(e){n.resolve(e.target.result)},r.onerror=function(e){n.reject(e.target.error)},r.readAsArrayBuffer(e),n.promise},addListFileAttachment:function(t,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(t,function(a){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(e){return e},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(e){o(e)},function(e){s(e)})})})},deleteListFileAttachment:function(t,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(t,function(s){e({url:t+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(e){i(e)},function(e){o(e)})})},getListItemType:function(e){return("SP.Data."+e[0].toUpperCase()+e.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(t,n,r,a,i,o){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){i(e)},function(e){o(e)})},getListItems:function(t,n,r,a,i){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){a(e)},function(e){i(e)})},addListItem:function(t,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(t,function(r){e({url:t+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(e){a(e)},function(e){i(e)})})},updateListItem:function(t,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(t,function(a){c(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":t.data.d.__metadata.etag}}).then(function(e){i(e)},function(e){o(e)})},function(e){o(e)})})},deleteListItem:function(t,n,r,a,i){var o=this.getListItem;this.getDigestValue(t,function(s){o(t,n,r,"",function(t){e({url:t.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":t.data.d.__metadata.etag}}).then(function(e){a(e)},function(e){i(e)})},function(e){i(e)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(e){return{$$silentChangePath:!1,silent:function(t,n){this.prev=e.path();var r=e.url(t);n&&r.replace(),this.$$silentChangePath=e.path()},box:function(e,t){t[e].__silentModeMarker||!function(){var n=t[e];t[e]=function(){t[e]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(e,t,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===t.path())for(var i in e.$$listeners.$locationChangeSuccess)n.box(i,e.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,e.$on("$locationChangeSuccess",r)}]),angular.module("setup",[]).controller("setupCtrl",["$scope","$http","$location","initializer","spService","imageStorage","configurationList",function(e,t,n,r,a,i,o){var s=null;e.folderURL="",e.save=function(){var c={PageURL:r.Url.main,SlideFolder:e.folderURL.replace(/(^[^A-Za-z0-9]+|[^A-Za-z0-9]+$)/g,""),encodeURL:r.encodeURL,options:JSON.stringify({headline:e.options.headline,labelheadline:e.options.labelheadline})};t({url:"https://"+r.Url.host+r.Url.base+"/_api/web/getFolderByServerRelativeUrl('"+r.Url.base+c.SlideFolder+"')/Files?$select=Title,Name,TimeCreated,TimeLastModified,ListItemAllFields/Description0, ListItemAllFields/OData__Author&$expand=Author,ListItemAllFields",method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(e){i.add(e.data.d.results),i.setFolderLocation(c.SlideFolder),0===i.get().length?console.log("Do not add or update because there is no images"):(console.log("good to post"),console.log("https://"+r.Url.host+r.Url.base),a.getListItems("https://"+r.Url.host+r.Url.base,o,"?$select=ID, PageURL, SlideFolder, encodeURL, options&$filter=encodeURL eq '"+r.encodeURL+"'",function(e){s=e.data.d.results,s.length>0?(console.log("updating the item for "+s[0].ID),a.updateListItem("https://"+r.Url.host+r.Url.base,o,s[0].ID,c,function(e){i.setIndex(1),i.setOptions(JSON.parse(c.options)),n.path("/slide/1")},function(e){})):a.addListItem("https://"+r.Url.host+r.Url.base,o,c,function(e){i.setIndex(1),i.setOptions(JSON.parse(c.options)),n.path("/slide/1")},function(e){})},function(e){}))},function(e){})}}]),angular.module("slide",[]).controller("slideShowCtrl",["$scope","$location","$routeParams","$ngSilentLocation","$rootScope","imageStorage","initializer",function(e,t,n,r,a,i,o){e.slides=[],e.currentSlideNum="",e.totalSlides="",e.options={},e.Url=o.Url,e.slideLocation=null,null===i.get()?(console.log("On slideShowCtrl and found no images"),o.run().then(function(r){e.slides=i.get(),e.options=i.getOptions(),0===e.slides.length&&t.path("/setup"),e.currentSlideNum=parseInt(n.index),e.totalSlides=e.slides.length,e.slideLocation=i.getFolderLocation(),i.setIndex(e.currentSlideNum)})):(console.log("there are images here"),e.slides=i.get(),e.options=i.getOptions(),e.slideLocation=i.getFolderLocation(),console.log(e.options),parseInt(n.index)<=e.slides.length?(e.currentSlideNum=parseInt(n.index),e.currentSlideNum!==i.getIndex()&&i.setIndex(e.currentSlideNum)):(e.currentSlideNum=i.getIndex(),t.path("/slide/"+e.currentSlideNum)),e.totalSlides=e.slides.length),e.leftArrow=function(){e.currentSlideNum-1<=0?(e.currentSlideNum=e.totalSlides,i.setIndex(e.currentSlideNum),r.silent("/slide/"+e.currentSlideNum)):(e.currentSlideNum-=1,i.setIndex(e.currentSlideNum),r.silent("/slide/"+e.currentSlideNum))},e.rightArrow=function(){e.currentSlideNum+1>e.totalSlides?(e.currentSlideNum=1,i.setIndex(e.currentSlideNum),r.silent("/slide/"+e.currentSlideNum)):(e.currentSlideNum+=1,i.setIndex(e.currentSlideNum),r.silent("/slide/"+e.currentSlideNum))}}]);