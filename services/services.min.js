!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function t(t,e){var n=i.indexOf(t.charAt(e));if(-1==n)throw"Cannot decode base64";return n}function e(e){e=""+e;var n,r,i,o=e.length;if(0==o)return e;if(0!=o%4)throw"Cannot decode base64";n=0,e.charAt(o-1)==a&&(n=1,e.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6|t(e,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=t(e,r)<<18|t(e,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(t,e){var n=t.charCodeAt(e);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(t){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var e,r,o=[];t=""+t;var s=t.length-t.length%3;if(0==t.length)return t;for(e=0;s>e;e+=3)r=n(t,e)<<16|n(t,e+1)<<8|n(t,e+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(t.length-s){case 1:r=n(t,e)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(t,e)<<16|n(t,e+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:e}}())}(),function(t,e,n){"use strict";function r(){function t(t,n){return e.extend(new(e.extend(function(){},{prototype:t})),n)}function n(t,e){var n=e.caseInsensitiveMatch,r={originalPath:t,regexp:t},a=r.keys=[];return t=t.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(t,e,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),e=e||"",""+(i?"":e)+"(?:"+(i?e:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+t+"$",n?"i":""),r}var r={};this.when=function(t,a){if(r[t]=e.extend({reloadOnSearch:!0},a,t&&n(t,a)),t){var i="/"==t[t.length-1]?t.substr(0,t.length-1):t+"/";r[i]=e.extend({redirectTo:t},n(i,a))}return this},this.otherwise=function(t){return this.when(null,t),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(t,e){var n=e.keys,r={};if(!e.regexp)return null;var a=e.regexp.exec(t);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function f(){var t=p(),r=m.current;t&&r&&t.$$route===r.$$route&&e.equals(t.pathParams,r.pathParams)&&!t.reloadOnSearch&&!g?(r.params=t.params,e.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(t||r)&&(g=!1,n.$broadcast("$routeChangeStart",t,r),m.current=t,t&&t.redirectTo&&(e.isString(t.redirectTo)?a.path(d(t.redirectTo,t.params)).search(t.params).replace():a.url(t.redirectTo(t.pathParams,a.path(),a.search())).replace()),o.when(t).then(function(){if(t){var n,r,a=e.extend({},t.resolve);return e.forEach(a,function(t,n){a[n]=e.isString(t)?s.get(t):s.invoke(t)}),e.isDefined(n=t.template)?e.isFunction(n)&&(n=n(t.params)):e.isDefined(r=t.templateUrl)&&(e.isFunction(r)&&(r=r(t.params)),r=l.getTrustedResourceUrl(r),e.isDefined(r)&&(t.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(t){return t.data}))),e.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){t==m.current&&(t&&(t.locals=a,e.copy(t.params,i)),n.$broadcast("$routeChangeSuccess",t,r))},function(e){t==m.current&&n.$broadcast("$routeChangeError",t,r,e)}))}function p(){var n,i;return e.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=t(r,{params:e.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&t(r[null],{params:{},pathParams:{}})}function d(t,n){var r=[];return e.forEach((t||"").split(":"),function(t,e){if(0===e)r.push(t);else{var a=t.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(f)}};return n.$on("$locationChangeSuccess",f),m}]}function a(){this.$get=function(){return{}}}function i(t,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),f&&(r.leave(f),f=null)}function l(){var o=t.current&&t.current.locals,s=o&&o.$template;if(e.isDefined(s)){var l=a.$new(),g=t.current,m=c(l,function(t){r.enter(t,null,f||i,function(){!e.isDefined(p)||p&&!a.$eval(p)||n()}),u()});f=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(d)}else u()}var h,f,p=o.autoscroll,d=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(t,e,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=t(a.contents());if(i.controller){o.$scope=r;var c=e(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=e.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(t,e,n){"use strict";function r(t){var n=[];return c(n,e.noop).chars(t),n.join("")}function a(t){var e={};t=t.split(",");var n;for(n=0;n<t.length;n++)e[t[n]]=!0;return e}function i(t,n){function r(t,r,i,s){if(r=e.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(f,function(t,e,n,r,a){u[e]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(t,r){var a,i=0;if(r=e.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=t;for(c.last=function(){return c[c.length-1]};t;){if(s=!0,c.last()&&y[c.last()]?(t=t.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(t,e){return e=e.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(e)),""}),a("",c.last())):(0===t.indexOf("<!--")?(i=t.indexOf("--",4),i>=0&&t.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(t.substring(4,i)),t=t.substring(i+3),s=!1)):m.test(t)?(i=t.match(m))&&(t=t.replace(i[0],""),s=!1):d.test(t)?(i=t.match(h))&&(t=t.substring(i[0].length),i[0].replace(h,a),s=!1):p.test(t)&&(i=t.match(l))&&(t=t.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=t.indexOf("<"),s=0>i?t:t.substring(0,i),t=0>i?"":t.substring(i),n.chars&&n.chars(o(s)))),t==v)throw u("badparse",t);v=t}a()}function o(t){if(!t)return"";var e=E.exec(t);t=e[1];var n=e[3];return(e=e[2])&&(D.innerHTML=e.replace(/</g,"&lt;"),e="textContent"in D?D.textContent:D.innerText),t+e+n}function s(t){return t.replace(/&/g,"&amp;").replace(v,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(t,n){var r=!1,a=e.bind(t,t.push);return{start:function(t,i,o){t=e.lowercase(t),!r&&y[t]&&(r=t),r||!0!==S[t]||(a("<"),a(t),e.forEach(i,function(r,i){var o=e.lowercase(i),c="img"===t&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(t){t=e.lowercase(t),r||!0!==S[t]||(a("</"),a(t),a(">")),t==r&&(r=!1)},chars:function(t){r||a(s(t))}}}var u=e.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,f=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,p=/^</,d=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");t=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=e.extend({},n,t),x=e.extend({},t,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=e.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),y=a("script,style"),S=e.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=e.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;e.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(t){return function(e){var n=[];return i(e,c(n,function(e,n){return!/^unsafe/.test(t(e,n))})),n.join("")}}]}),e.module("ngSanitize").filter("linky",["$sanitize",function(t){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(t){t&&p.push(r(t))}function c(t,n){p.push("<a "),e.isDefined(o)&&(p.push('target="'),p.push(o),p.push('" ')),p.push('href="'),p.push(t),p.push('">'),s(n),p.push("</a>")}if(!i)return i;for(var u,l,h,f=i,p=[];u=f.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(f.substr(0,h)),c(l,u[0].replace(a,"")),f=f.substring(h+u[0].length);return s(f),t(p.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(t,e){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(e,r){null!=n?r(n):t({url:e+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(t){n=t.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(t){alert("Cannot get digestValue.")})},getFileBuffer:function(t){var n=e.defer(),r=new FileReader;return r.onload=function(t){n.resolve(t.target.result)},r.onerror=function(t){n.reject(t.target.error)},r.readAsArrayBuffer(t),n.promise},addListFileAttachment:function(e,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(e,function(a){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(t){return t},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(t){o(t)},function(t){s(t)})})})},deleteListFileAttachment:function(e,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(e,function(s){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(t){i(t)},function(t){o(t)})})},getListItemType:function(t){return("SP.Data."+t[0].toUpperCase()+t.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(e,n,r,a,i,o){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){i(t)},function(t){o(t)})},getListItems:function(e,n,r,a,i){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){a(t)},function(t){i(t)})},addListItem:function(e,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(e,function(r){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(t){a(t)},function(t){i(t)})})},updateListItem:function(e,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(e,function(a){c(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":e.data.d.__metadata.etag}}).then(function(t){i(t)},function(t){o(t)})},function(t){o(t)})})},deleteListItem:function(e,n,r,a,i){var o=this.getListItem;this.getDigestValue(e,function(s){o(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":e.data.d.__metadata.etag}}).then(function(t){a(t)},function(t){i(t)})},function(t){i(t)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(t){return{$$silentChangePath:!1,silent:function(e,n){this.prev=t.path();var r=t.url(e);n&&r.replace(),this.$$silentChangePath=t.path()},box:function(t,e){e[t].__silentModeMarker||!function(){var n=e[t];e[t]=function(){e[t]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(t,e,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===e.path())for(var i in t.$$listeners.$locationChangeSuccess)n.box(i,t.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,t.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function t(t,e){var n=i.indexOf(t.charAt(e));if(-1==n)throw"Cannot decode base64";return n}function e(e){e=""+e;var n,r,i,o=e.length;if(0==o)return e;if(0!=o%4)throw"Cannot decode base64";n=0,e.charAt(o-1)==a&&(n=1,e.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6|t(e,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=t(e,r)<<18|t(e,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(t,e){var n=t.charCodeAt(e);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(t){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var e,r,o=[];t=""+t;var s=t.length-t.length%3;if(0==t.length)return t;for(e=0;s>e;e+=3)r=n(t,e)<<16|n(t,e+1)<<8|n(t,e+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(t.length-s){case 1:r=n(t,e)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(t,e)<<16|n(t,e+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:e}}())}(),function(t,e,n){"use strict";function r(){function t(t,n){return e.extend(new(e.extend(function(){},{prototype:t})),n)}function n(t,e){var n=e.caseInsensitiveMatch,r={originalPath:t,regexp:t},a=r.keys=[];return t=t.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(t,e,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),e=e||"",""+(i?"":e)+"(?:"+(i?e:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+t+"$",n?"i":""),r}var r={};this.when=function(t,a){if(r[t]=e.extend({reloadOnSearch:!0},a,t&&n(t,a)),t){var i="/"==t[t.length-1]?t.substr(0,t.length-1):t+"/";r[i]=e.extend({redirectTo:t},n(i,a))}return this},this.otherwise=function(t){return this.when(null,t),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(t,e){var n=e.keys,r={};if(!e.regexp)return null;var a=e.regexp.exec(t);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function f(){var t=p(),r=m.current;t&&r&&t.$$route===r.$$route&&e.equals(t.pathParams,r.pathParams)&&!t.reloadOnSearch&&!g?(r.params=t.params,e.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(t||r)&&(g=!1,n.$broadcast("$routeChangeStart",t,r),m.current=t,t&&t.redirectTo&&(e.isString(t.redirectTo)?a.path(d(t.redirectTo,t.params)).search(t.params).replace():a.url(t.redirectTo(t.pathParams,a.path(),a.search())).replace()),o.when(t).then(function(){if(t){var n,r,a=e.extend({},t.resolve);return e.forEach(a,function(t,n){a[n]=e.isString(t)?s.get(t):s.invoke(t)}),e.isDefined(n=t.template)?e.isFunction(n)&&(n=n(t.params)):e.isDefined(r=t.templateUrl)&&(e.isFunction(r)&&(r=r(t.params)),r=l.getTrustedResourceUrl(r),e.isDefined(r)&&(t.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(t){return t.data}))),e.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){t==m.current&&(t&&(t.locals=a,e.copy(t.params,i)),n.$broadcast("$routeChangeSuccess",t,r))},function(e){t==m.current&&n.$broadcast("$routeChangeError",t,r,e)}))}function p(){var n,i;return e.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=t(r,{params:e.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&t(r[null],{params:{},pathParams:{}})}function d(t,n){var r=[];return e.forEach((t||"").split(":"),function(t,e){if(0===e)r.push(t);else{var a=t.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(f)}};return n.$on("$locationChangeSuccess",f),m}]}function a(){this.$get=function(){return{}}}function i(t,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),f&&(r.leave(f),f=null)}function l(){var o=t.current&&t.current.locals,s=o&&o.$template;if(e.isDefined(s)){var l=a.$new(),g=t.current,m=c(l,function(t){r.enter(t,null,f||i,function(){!e.isDefined(p)||p&&!a.$eval(p)||n()}),u()});f=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(d)}else u()}var h,f,p=o.autoscroll,d=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(t,e,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=t(a.contents());if(i.controller){o.$scope=r;var c=e(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=e.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(t,e,n){"use strict";function r(t){var n=[];return c(n,e.noop).chars(t),n.join("")}function a(t){var e={};t=t.split(",");var n;for(n=0;n<t.length;n++)e[t[n]]=!0;return e}function i(t,n){function r(t,r,i,s){if(r=e.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(f,function(t,e,n,r,a){u[e]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(t,r){var a,i=0;if(r=e.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=t;for(c.last=function(){return c[c.length-1]};t;){if(s=!0,c.last()&&y[c.last()]?(t=t.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(t,e){return e=e.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(e)),""}),a("",c.last())):(0===t.indexOf("<!--")?(i=t.indexOf("--",4),i>=0&&t.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(t.substring(4,i)),t=t.substring(i+3),s=!1)):m.test(t)?(i=t.match(m))&&(t=t.replace(i[0],""),s=!1):d.test(t)?(i=t.match(h))&&(t=t.substring(i[0].length),i[0].replace(h,a),s=!1):p.test(t)&&(i=t.match(l))&&(t=t.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=t.indexOf("<"),s=0>i?t:t.substring(0,i),t=0>i?"":t.substring(i),n.chars&&n.chars(o(s)))),t==v)throw u("badparse",t);v=t}a()}function o(t){if(!t)return"";var e=E.exec(t);t=e[1];var n=e[3];return(e=e[2])&&(D.innerHTML=e.replace(/</g,"&lt;"),e="textContent"in D?D.textContent:D.innerText),t+e+n}function s(t){return t.replace(/&/g,"&amp;").replace(v,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(t,n){var r=!1,a=e.bind(t,t.push);return{start:function(t,i,o){t=e.lowercase(t),!r&&y[t]&&(r=t),r||!0!==S[t]||(a("<"),a(t),e.forEach(i,function(r,i){var o=e.lowercase(i),c="img"===t&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(t){t=e.lowercase(t),r||!0!==S[t]||(a("</"),a(t),a(">")),t==r&&(r=!1)},chars:function(t){r||a(s(t))}}}var u=e.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,f=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,p=/^</,d=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");t=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=e.extend({},n,t),x=e.extend({},t,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=e.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),y=a("script,style"),S=e.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=e.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;e.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(t){return function(e){var n=[];return i(e,c(n,function(e,n){return!/^unsafe/.test(t(e,n))})),n.join("")}}]}),e.module("ngSanitize").filter("linky",["$sanitize",function(t){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(t){t&&p.push(r(t))}function c(t,n){p.push("<a "),e.isDefined(o)&&(p.push('target="'),p.push(o),p.push('" ')),p.push('href="'),p.push(t),p.push('">'),s(n),p.push("</a>")}if(!i)return i;for(var u,l,h,f=i,p=[];u=f.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(f.substr(0,h)),c(l,u[0].replace(a,"")),f=f.substring(h+u[0].length);return s(f),t(p.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(t,e){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(e,r){null!=n?r(n):t({url:e+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(t){n=t.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(t){alert("Cannot get digestValue.")})},getFileBuffer:function(t){var n=e.defer(),r=new FileReader;return r.onload=function(t){n.resolve(t.target.result)},r.onerror=function(t){n.reject(t.target.error)},r.readAsArrayBuffer(t),n.promise},addListFileAttachment:function(e,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(e,function(a){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(t){return t},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(t){o(t)},function(t){s(t)})})})},deleteListFileAttachment:function(e,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(e,function(s){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(t){i(t)},function(t){o(t)})})},getListItemType:function(t){return("SP.Data."+t[0].toUpperCase()+t.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(e,n,r,a,i,o){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){i(t)},function(t){o(t)})},getListItems:function(e,n,r,a,i){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){a(t)},function(t){i(t)})},addListItem:function(e,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(e,function(r){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(t){a(t)},function(t){i(t)})})},updateListItem:function(e,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(e,function(a){c(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":e.data.d.__metadata.etag}}).then(function(t){i(t)},function(t){o(t)})},function(t){o(t)})})},deleteListItem:function(e,n,r,a,i){var o=this.getListItem;this.getDigestValue(e,function(s){o(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":e.data.d.__metadata.etag}}).then(function(t){a(t)},function(t){i(t)})},function(t){i(t)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(t){return{$$silentChangePath:!1,silent:function(e,n){this.prev=t.path();var r=t.url(e);n&&r.replace(),this.$$silentChangePath=t.path()},box:function(t,e){e[t].__silentModeMarker||!function(){var n=e[t];e[t]=function(){e[t]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(t,e,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===e.path())for(var i in t.$$listeners.$locationChangeSuccess)n.box(i,t.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,t.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function t(t,e){var n=i.indexOf(t.charAt(e));if(-1==n)throw"Cannot decode base64";return n}function e(e){e=""+e;var n,r,i,o=e.length;if(0==o)return e;if(0!=o%4)throw"Cannot decode base64";n=0,e.charAt(o-1)==a&&(n=1,e.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6|t(e,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=t(e,r)<<18|t(e,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(t,e){var n=t.charCodeAt(e);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(t){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var e,r,o=[];t=""+t;var s=t.length-t.length%3;if(0==t.length)return t;for(e=0;s>e;e+=3)r=n(t,e)<<16|n(t,e+1)<<8|n(t,e+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(t.length-s){case 1:r=n(t,e)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(t,e)<<16|n(t,e+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:e}}())}(),function(t,e,n){"use strict";function r(){function t(t,n){return e.extend(new(e.extend(function(){},{prototype:t})),n)}function n(t,e){var n=e.caseInsensitiveMatch,r={originalPath:t,regexp:t},a=r.keys=[];return t=t.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(t,e,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),e=e||"",""+(i?"":e)+"(?:"+(i?e:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+t+"$",n?"i":""),r}var r={};this.when=function(t,a){if(r[t]=e.extend({reloadOnSearch:!0},a,t&&n(t,a)),t){var i="/"==t[t.length-1]?t.substr(0,t.length-1):t+"/";r[i]=e.extend({redirectTo:t},n(i,a))}return this},this.otherwise=function(t){return this.when(null,t),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(t,e){var n=e.keys,r={};if(!e.regexp)return null;var a=e.regexp.exec(t);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function f(){var t=p(),r=m.current;t&&r&&t.$$route===r.$$route&&e.equals(t.pathParams,r.pathParams)&&!t.reloadOnSearch&&!g?(r.params=t.params,e.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(t||r)&&(g=!1,n.$broadcast("$routeChangeStart",t,r),m.current=t,t&&t.redirectTo&&(e.isString(t.redirectTo)?a.path(d(t.redirectTo,t.params)).search(t.params).replace():a.url(t.redirectTo(t.pathParams,a.path(),a.search())).replace()),o.when(t).then(function(){if(t){var n,r,a=e.extend({},t.resolve);return e.forEach(a,function(t,n){a[n]=e.isString(t)?s.get(t):s.invoke(t)}),e.isDefined(n=t.template)?e.isFunction(n)&&(n=n(t.params)):e.isDefined(r=t.templateUrl)&&(e.isFunction(r)&&(r=r(t.params)),r=l.getTrustedResourceUrl(r),e.isDefined(r)&&(t.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(t){return t.data}))),e.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){t==m.current&&(t&&(t.locals=a,e.copy(t.params,i)),n.$broadcast("$routeChangeSuccess",t,r))},function(e){t==m.current&&n.$broadcast("$routeChangeError",t,r,e)}))}function p(){var n,i;return e.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=t(r,{params:e.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&t(r[null],{params:{},pathParams:{}})}function d(t,n){var r=[];return e.forEach((t||"").split(":"),function(t,e){if(0===e)r.push(t);else{var a=t.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(f)}};return n.$on("$locationChangeSuccess",f),m}]}function a(){this.$get=function(){return{}}}function i(t,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),f&&(r.leave(f),f=null)}function l(){var o=t.current&&t.current.locals,s=o&&o.$template;if(e.isDefined(s)){var l=a.$new(),g=t.current,m=c(l,function(t){r.enter(t,null,f||i,function(){!e.isDefined(p)||p&&!a.$eval(p)||n()}),u()});f=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(d)}else u()}var h,f,p=o.autoscroll,d=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(t,e,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=t(a.contents());if(i.controller){o.$scope=r;var c=e(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=e.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(t,e,n){"use strict";function r(t){var n=[];return c(n,e.noop).chars(t),n.join("")}function a(t){var e={};t=t.split(",");var n;for(n=0;n<t.length;n++)e[t[n]]=!0;return e}function i(t,n){function r(t,r,i,s){if(r=e.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(f,function(t,e,n,r,a){u[e]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(t,r){
var a,i=0;if(r=e.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=t;for(c.last=function(){return c[c.length-1]};t;){if(s=!0,c.last()&&y[c.last()]?(t=t.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(t,e){return e=e.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(e)),""}),a("",c.last())):(0===t.indexOf("<!--")?(i=t.indexOf("--",4),i>=0&&t.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(t.substring(4,i)),t=t.substring(i+3),s=!1)):m.test(t)?(i=t.match(m))&&(t=t.replace(i[0],""),s=!1):d.test(t)?(i=t.match(h))&&(t=t.substring(i[0].length),i[0].replace(h,a),s=!1):p.test(t)&&(i=t.match(l))&&(t=t.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=t.indexOf("<"),s=0>i?t:t.substring(0,i),t=0>i?"":t.substring(i),n.chars&&n.chars(o(s)))),t==v)throw u("badparse",t);v=t}a()}function o(t){if(!t)return"";var e=E.exec(t);t=e[1];var n=e[3];return(e=e[2])&&(D.innerHTML=e.replace(/</g,"&lt;"),e="textContent"in D?D.textContent:D.innerText),t+e+n}function s(t){return t.replace(/&/g,"&amp;").replace(v,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(t,n){var r=!1,a=e.bind(t,t.push);return{start:function(t,i,o){t=e.lowercase(t),!r&&y[t]&&(r=t),r||!0!==S[t]||(a("<"),a(t),e.forEach(i,function(r,i){var o=e.lowercase(i),c="img"===t&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(t){t=e.lowercase(t),r||!0!==S[t]||(a("</"),a(t),a(">")),t==r&&(r=!1)},chars:function(t){r||a(s(t))}}}var u=e.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,f=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,p=/^</,d=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");t=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=e.extend({},n,t),x=e.extend({},t,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=e.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),y=a("script,style"),S=e.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=e.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;e.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(t){return function(e){var n=[];return i(e,c(n,function(e,n){return!/^unsafe/.test(t(e,n))})),n.join("")}}]}),e.module("ngSanitize").filter("linky",["$sanitize",function(t){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(t){t&&p.push(r(t))}function c(t,n){p.push("<a "),e.isDefined(o)&&(p.push('target="'),p.push(o),p.push('" ')),p.push('href="'),p.push(t),p.push('">'),s(n),p.push("</a>")}if(!i)return i;for(var u,l,h,f=i,p=[];u=f.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(f.substr(0,h)),c(l,u[0].replace(a,"")),f=f.substring(h+u[0].length);return s(f),t(p.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(t,e){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(e,r){null!=n?r(n):t({url:e+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(t){n=t.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(t){alert("Cannot get digestValue.")})},getFileBuffer:function(t){var n=e.defer(),r=new FileReader;return r.onload=function(t){n.resolve(t.target.result)},r.onerror=function(t){n.reject(t.target.error)},r.readAsArrayBuffer(t),n.promise},addListFileAttachment:function(e,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(e,function(a){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(t){return t},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(t){o(t)},function(t){s(t)})})})},deleteListFileAttachment:function(e,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(e,function(s){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(t){i(t)},function(t){o(t)})})},getListItemType:function(t){return("SP.Data."+t[0].toUpperCase()+t.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(e,n,r,a,i,o){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){i(t)},function(t){o(t)})},getListItems:function(e,n,r,a,i){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){a(t)},function(t){i(t)})},addListItem:function(e,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(e,function(r){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(t){a(t)},function(t){i(t)})})},updateListItem:function(e,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(e,function(a){c(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":e.data.d.__metadata.etag}}).then(function(t){i(t)},function(t){o(t)})},function(t){o(t)})})},deleteListItem:function(e,n,r,a,i){var o=this.getListItem;this.getDigestValue(e,function(s){o(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":e.data.d.__metadata.etag}}).then(function(t){a(t)},function(t){i(t)})},function(t){i(t)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(t){return{$$silentChangePath:!1,silent:function(e,n){this.prev=t.path();var r=t.url(e);n&&r.replace(),this.$$silentChangePath=t.path()},box:function(t,e){e[t].__silentModeMarker||!function(){var n=e[t];e[t]=function(){e[t]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(t,e,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===e.path())for(var i in t.$$listeners.$locationChangeSuccess)n.box(i,t.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,t.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function t(t,e){var n=i.indexOf(t.charAt(e));if(-1==n)throw"Cannot decode base64";return n}function e(e){e=""+e;var n,r,i,o=e.length;if(0==o)return e;if(0!=o%4)throw"Cannot decode base64";n=0,e.charAt(o-1)==a&&(n=1,e.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6|t(e,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=t(e,r)<<18|t(e,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(t,e){var n=t.charCodeAt(e);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(t){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var e,r,o=[];t=""+t;var s=t.length-t.length%3;if(0==t.length)return t;for(e=0;s>e;e+=3)r=n(t,e)<<16|n(t,e+1)<<8|n(t,e+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(t.length-s){case 1:r=n(t,e)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(t,e)<<16|n(t,e+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:e}}())}(),function(t,e,n){"use strict";function r(){function t(t,n){return e.extend(new(e.extend(function(){},{prototype:t})),n)}function n(t,e){var n=e.caseInsensitiveMatch,r={originalPath:t,regexp:t},a=r.keys=[];return t=t.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(t,e,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),e=e||"",""+(i?"":e)+"(?:"+(i?e:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+t+"$",n?"i":""),r}var r={};this.when=function(t,a){if(r[t]=e.extend({reloadOnSearch:!0},a,t&&n(t,a)),t){var i="/"==t[t.length-1]?t.substr(0,t.length-1):t+"/";r[i]=e.extend({redirectTo:t},n(i,a))}return this},this.otherwise=function(t){return this.when(null,t),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(t,e){var n=e.keys,r={};if(!e.regexp)return null;var a=e.regexp.exec(t);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function f(){var t=p(),r=m.current;t&&r&&t.$$route===r.$$route&&e.equals(t.pathParams,r.pathParams)&&!t.reloadOnSearch&&!g?(r.params=t.params,e.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(t||r)&&(g=!1,n.$broadcast("$routeChangeStart",t,r),m.current=t,t&&t.redirectTo&&(e.isString(t.redirectTo)?a.path(d(t.redirectTo,t.params)).search(t.params).replace():a.url(t.redirectTo(t.pathParams,a.path(),a.search())).replace()),o.when(t).then(function(){if(t){var n,r,a=e.extend({},t.resolve);return e.forEach(a,function(t,n){a[n]=e.isString(t)?s.get(t):s.invoke(t)}),e.isDefined(n=t.template)?e.isFunction(n)&&(n=n(t.params)):e.isDefined(r=t.templateUrl)&&(e.isFunction(r)&&(r=r(t.params)),r=l.getTrustedResourceUrl(r),e.isDefined(r)&&(t.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(t){return t.data}))),e.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){t==m.current&&(t&&(t.locals=a,e.copy(t.params,i)),n.$broadcast("$routeChangeSuccess",t,r))},function(e){t==m.current&&n.$broadcast("$routeChangeError",t,r,e)}))}function p(){var n,i;return e.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=t(r,{params:e.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&t(r[null],{params:{},pathParams:{}})}function d(t,n){var r=[];return e.forEach((t||"").split(":"),function(t,e){if(0===e)r.push(t);else{var a=t.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(f)}};return n.$on("$locationChangeSuccess",f),m}]}function a(){this.$get=function(){return{}}}function i(t,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),f&&(r.leave(f),f=null)}function l(){var o=t.current&&t.current.locals,s=o&&o.$template;if(e.isDefined(s)){var l=a.$new(),g=t.current,m=c(l,function(t){r.enter(t,null,f||i,function(){!e.isDefined(p)||p&&!a.$eval(p)||n()}),u()});f=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(d)}else u()}var h,f,p=o.autoscroll,d=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(t,e,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=t(a.contents());if(i.controller){o.$scope=r;var c=e(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=e.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(t,e,n){"use strict";function r(t){var n=[];return c(n,e.noop).chars(t),n.join("")}function a(t){var e={};t=t.split(",");var n;for(n=0;n<t.length;n++)e[t[n]]=!0;return e}function i(t,n){function r(t,r,i,s){if(r=e.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(f,function(t,e,n,r,a){u[e]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(t,r){var a,i=0;if(r=e.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=t;for(c.last=function(){return c[c.length-1]};t;){if(s=!0,c.last()&&y[c.last()]?(t=t.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(t,e){return e=e.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(e)),""}),a("",c.last())):(0===t.indexOf("<!--")?(i=t.indexOf("--",4),i>=0&&t.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(t.substring(4,i)),t=t.substring(i+3),s=!1)):m.test(t)?(i=t.match(m))&&(t=t.replace(i[0],""),s=!1):d.test(t)?(i=t.match(h))&&(t=t.substring(i[0].length),i[0].replace(h,a),s=!1):p.test(t)&&(i=t.match(l))&&(t=t.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=t.indexOf("<"),s=0>i?t:t.substring(0,i),t=0>i?"":t.substring(i),n.chars&&n.chars(o(s)))),t==v)throw u("badparse",t);v=t}a()}function o(t){if(!t)return"";var e=E.exec(t);t=e[1];var n=e[3];return(e=e[2])&&(D.innerHTML=e.replace(/</g,"&lt;"),e="textContent"in D?D.textContent:D.innerText),t+e+n}function s(t){return t.replace(/&/g,"&amp;").replace(v,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(t,n){var r=!1,a=e.bind(t,t.push);return{start:function(t,i,o){t=e.lowercase(t),!r&&y[t]&&(r=t),r||!0!==S[t]||(a("<"),a(t),e.forEach(i,function(r,i){var o=e.lowercase(i),c="img"===t&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(t){t=e.lowercase(t),r||!0!==S[t]||(a("</"),a(t),a(">")),t==r&&(r=!1)},chars:function(t){r||a(s(t))}}}var u=e.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,f=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,p=/^</,d=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");t=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=e.extend({},n,t),x=e.extend({},t,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=e.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),y=a("script,style"),S=e.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=e.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;e.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(t){return function(e){var n=[];return i(e,c(n,function(e,n){return!/^unsafe/.test(t(e,n))})),n.join("")}}]}),e.module("ngSanitize").filter("linky",["$sanitize",function(t){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(t){t&&p.push(r(t))}function c(t,n){p.push("<a "),e.isDefined(o)&&(p.push('target="'),p.push(o),p.push('" ')),p.push('href="'),p.push(t),p.push('">'),s(n),p.push("</a>")}if(!i)return i;for(var u,l,h,f=i,p=[];u=f.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(f.substr(0,h)),c(l,u[0].replace(a,"")),f=f.substring(h+u[0].length);return s(f),t(p.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(t,e){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(e,r){null!=n?r(n):t({url:e+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(t){n=t.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(t){alert("Cannot get digestValue.")})},getFileBuffer:function(t){var n=e.defer(),r=new FileReader;return r.onload=function(t){n.resolve(t.target.result)},r.onerror=function(t){n.reject(t.target.error)},r.readAsArrayBuffer(t),n.promise},addListFileAttachment:function(e,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(e,function(a){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(t){return t},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(t){o(t)},function(t){s(t)})})})},deleteListFileAttachment:function(e,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(e,function(s){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(t){i(t)},function(t){o(t)})})},getListItemType:function(t){return("SP.Data."+t[0].toUpperCase()+t.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(e,n,r,a,i,o){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){i(t)},function(t){o(t)})},getListItems:function(e,n,r,a,i){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){a(t)},function(t){i(t)})},addListItem:function(e,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(e,function(r){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(t){a(t)},function(t){i(t)})})},updateListItem:function(e,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(e,function(a){c(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":e.data.d.__metadata.etag}}).then(function(t){i(t)},function(t){o(t)})},function(t){o(t)})})},deleteListItem:function(e,n,r,a,i){var o=this.getListItem;this.getDigestValue(e,function(s){o(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":e.data.d.__metadata.etag}}).then(function(t){a(t)},function(t){i(t)})},function(t){i(t)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(t){return{$$silentChangePath:!1,silent:function(e,n){this.prev=t.path();var r=t.url(e);n&&r.replace(),this.$$silentChangePath=t.path()},box:function(t,e){e[t].__silentModeMarker||!function(){var n=e[t];e[t]=function(){e[t]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(t,e,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===e.path())for(var i in t.$$listeners.$locationChangeSuccess)n.box(i,t.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,t.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function t(t,e){var n=i.indexOf(t.charAt(e));if(-1==n)throw"Cannot decode base64";return n}function e(e){e=""+e;var n,r,i,o=e.length;if(0==o)return e;if(0!=o%4)throw"Cannot decode base64";n=0,e.charAt(o-1)==a&&(n=1,e.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6|t(e,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=t(e,r)<<18|t(e,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(t,e){var n=t.charCodeAt(e);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(t){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var e,r,o=[];t=""+t;var s=t.length-t.length%3;if(0==t.length)return t;for(e=0;s>e;e+=3)r=n(t,e)<<16|n(t,e+1)<<8|n(t,e+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(t.length-s){case 1:r=n(t,e)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(t,e)<<16|n(t,e+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:e}}())}(),function(t,e,n){"use strict";function r(){function t(t,n){return e.extend(new(e.extend(function(){},{prototype:t})),n)}function n(t,e){var n=e.caseInsensitiveMatch,r={originalPath:t,regexp:t},a=r.keys=[];return t=t.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(t,e,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),e=e||"",""+(i?"":e)+"(?:"+(i?e:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+t+"$",n?"i":""),r}var r={};this.when=function(t,a){if(r[t]=e.extend({reloadOnSearch:!0},a,t&&n(t,a)),t){var i="/"==t[t.length-1]?t.substr(0,t.length-1):t+"/";r[i]=e.extend({redirectTo:t},n(i,a))}return this},this.otherwise=function(t){return this.when(null,t),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(t,e){var n=e.keys,r={};if(!e.regexp)return null;var a=e.regexp.exec(t);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function f(){var t=p(),r=m.current;t&&r&&t.$$route===r.$$route&&e.equals(t.pathParams,r.pathParams)&&!t.reloadOnSearch&&!g?(r.params=t.params,e.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(t||r)&&(g=!1,n.$broadcast("$routeChangeStart",t,r),m.current=t,t&&t.redirectTo&&(e.isString(t.redirectTo)?a.path(d(t.redirectTo,t.params)).search(t.params).replace():a.url(t.redirectTo(t.pathParams,a.path(),a.search())).replace()),o.when(t).then(function(){if(t){var n,r,a=e.extend({},t.resolve);return e.forEach(a,function(t,n){a[n]=e.isString(t)?s.get(t):s.invoke(t)}),e.isDefined(n=t.template)?e.isFunction(n)&&(n=n(t.params)):e.isDefined(r=t.templateUrl)&&(e.isFunction(r)&&(r=r(t.params)),r=l.getTrustedResourceUrl(r),e.isDefined(r)&&(t.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(t){return t.data}))),e.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){t==m.current&&(t&&(t.locals=a,e.copy(t.params,i)),n.$broadcast("$routeChangeSuccess",t,r))},function(e){t==m.current&&n.$broadcast("$routeChangeError",t,r,e)}))}function p(){var n,i;return e.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=t(r,{params:e.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&t(r[null],{params:{},pathParams:{}})}function d(t,n){var r=[];return e.forEach((t||"").split(":"),function(t,e){if(0===e)r.push(t);else{var a=t.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(f)}};return n.$on("$locationChangeSuccess",f),m}]}function a(){this.$get=function(){return{}}}function i(t,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),f&&(r.leave(f),f=null)}function l(){var o=t.current&&t.current.locals,s=o&&o.$template;if(e.isDefined(s)){var l=a.$new(),g=t.current,m=c(l,function(t){r.enter(t,null,f||i,function(){!e.isDefined(p)||p&&!a.$eval(p)||n()}),u()});f=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(d)}else u()}var h,f,p=o.autoscroll,d=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(t,e,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=t(a.contents());if(i.controller){o.$scope=r;var c=e(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=e.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(t,e,n){"use strict";function r(t){var n=[];return c(n,e.noop).chars(t),n.join("")}function a(t){var e={};t=t.split(",");var n;for(n=0;n<t.length;n++)e[t[n]]=!0;return e}function i(t,n){function r(t,r,i,s){if(r=e.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(f,function(t,e,n,r,a){u[e]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(t,r){var a,i=0;if(r=e.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=t;for(c.last=function(){return c[c.length-1]};t;){if(s=!0,c.last()&&y[c.last()]?(t=t.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(t,e){return e=e.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(e)),""}),a("",c.last())):(0===t.indexOf("<!--")?(i=t.indexOf("--",4),i>=0&&t.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(t.substring(4,i)),t=t.substring(i+3),s=!1)):m.test(t)?(i=t.match(m))&&(t=t.replace(i[0],""),s=!1):d.test(t)?(i=t.match(h))&&(t=t.substring(i[0].length),i[0].replace(h,a),s=!1):p.test(t)&&(i=t.match(l))&&(t=t.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=t.indexOf("<"),s=0>i?t:t.substring(0,i),t=0>i?"":t.substring(i),n.chars&&n.chars(o(s)))),t==v)throw u("badparse",t);v=t}a()}function o(t){if(!t)return"";var e=E.exec(t);t=e[1];var n=e[3];return(e=e[2])&&(D.innerHTML=e.replace(/</g,"&lt;"),e="textContent"in D?D.textContent:D.innerText),t+e+n}function s(t){return t.replace(/&/g,"&amp;").replace(v,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(t,n){var r=!1,a=e.bind(t,t.push);return{start:function(t,i,o){t=e.lowercase(t),!r&&y[t]&&(r=t),r||!0!==S[t]||(a("<"),a(t),e.forEach(i,function(r,i){var o=e.lowercase(i),c="img"===t&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(t){t=e.lowercase(t),r||!0!==S[t]||(a("</"),a(t),a(">")),t==r&&(r=!1)},chars:function(t){r||a(s(t))}}}var u=e.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,f=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,p=/^</,d=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");t=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=e.extend({},n,t),x=e.extend({},t,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=e.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),y=a("script,style"),S=e.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=e.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;e.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(t){return function(e){var n=[];return i(e,c(n,function(e,n){return!/^unsafe/.test(t(e,n))})),n.join("")}}]}),e.module("ngSanitize").filter("linky",["$sanitize",function(t){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(t){t&&p.push(r(t))}function c(t,n){p.push("<a "),e.isDefined(o)&&(p.push('target="'),p.push(o),p.push('" ')),p.push('href="'),p.push(t),p.push('">'),s(n),p.push("</a>")}if(!i)return i;for(var u,l,h,f=i,p=[];u=f.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(f.substr(0,h)),c(l,u[0].replace(a,"")),f=f.substring(h+u[0].length);return s(f),t(p.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(t,e){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(e,r){null!=n?r(n):t({url:e+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(t){n=t.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(t){alert("Cannot get digestValue.")})},getFileBuffer:function(t){var n=e.defer(),r=new FileReader;return r.onload=function(t){n.resolve(t.target.result)},r.onerror=function(t){n.reject(t.target.error)},r.readAsArrayBuffer(t),n.promise},addListFileAttachment:function(e,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(e,function(a){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(t){return t},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(t){o(t)},function(t){s(t)})})})},deleteListFileAttachment:function(e,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(e,function(s){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(t){i(t)},function(t){o(t)})})},getListItemType:function(t){return("SP.Data."+t[0].toUpperCase()+t.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(e,n,r,a,i,o){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){i(t)},function(t){o(t);

})},getListItems:function(e,n,r,a,i){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){a(t)},function(t){i(t)})},addListItem:function(e,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(e,function(r){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(t){a(t)},function(t){i(t)})})},updateListItem:function(e,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(e,function(a){c(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":e.data.d.__metadata.etag}}).then(function(t){i(t)},function(t){o(t)})},function(t){o(t)})})},deleteListItem:function(e,n,r,a,i){var o=this.getListItem;this.getDigestValue(e,function(s){o(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":e.data.d.__metadata.etag}}).then(function(t){a(t)},function(t){i(t)})},function(t){i(t)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(t){return{$$silentChangePath:!1,silent:function(e,n){this.prev=t.path();var r=t.url(e);n&&r.replace(),this.$$silentChangePath=t.path()},box:function(t,e){e[t].__silentModeMarker||!function(){var n=e[t];e[t]=function(){e[t]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(t,e,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===e.path())for(var i in t.$$listeners.$locationChangeSuccess)n.box(i,t.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,t.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function t(t,e){var n=i.indexOf(t.charAt(e));if(-1==n)throw"Cannot decode base64";return n}function e(e){e=""+e;var n,r,i,o=e.length;if(0==o)return e;if(0!=o%4)throw"Cannot decode base64";n=0,e.charAt(o-1)==a&&(n=1,e.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6|t(e,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=t(e,r)<<18|t(e,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(t,e){var n=t.charCodeAt(e);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(t){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var e,r,o=[];t=""+t;var s=t.length-t.length%3;if(0==t.length)return t;for(e=0;s>e;e+=3)r=n(t,e)<<16|n(t,e+1)<<8|n(t,e+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(t.length-s){case 1:r=n(t,e)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(t,e)<<16|n(t,e+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:e}}())}(),function(t,e,n){"use strict";function r(){function t(t,n){return e.extend(new(e.extend(function(){},{prototype:t})),n)}function n(t,e){var n=e.caseInsensitiveMatch,r={originalPath:t,regexp:t},a=r.keys=[];return t=t.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(t,e,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),e=e||"",""+(i?"":e)+"(?:"+(i?e:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+t+"$",n?"i":""),r}var r={};this.when=function(t,a){if(r[t]=e.extend({reloadOnSearch:!0},a,t&&n(t,a)),t){var i="/"==t[t.length-1]?t.substr(0,t.length-1):t+"/";r[i]=e.extend({redirectTo:t},n(i,a))}return this},this.otherwise=function(t){return this.when(null,t),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(t,e){var n=e.keys,r={};if(!e.regexp)return null;var a=e.regexp.exec(t);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function f(){var t=p(),r=m.current;t&&r&&t.$$route===r.$$route&&e.equals(t.pathParams,r.pathParams)&&!t.reloadOnSearch&&!g?(r.params=t.params,e.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(t||r)&&(g=!1,n.$broadcast("$routeChangeStart",t,r),m.current=t,t&&t.redirectTo&&(e.isString(t.redirectTo)?a.path(d(t.redirectTo,t.params)).search(t.params).replace():a.url(t.redirectTo(t.pathParams,a.path(),a.search())).replace()),o.when(t).then(function(){if(t){var n,r,a=e.extend({},t.resolve);return e.forEach(a,function(t,n){a[n]=e.isString(t)?s.get(t):s.invoke(t)}),e.isDefined(n=t.template)?e.isFunction(n)&&(n=n(t.params)):e.isDefined(r=t.templateUrl)&&(e.isFunction(r)&&(r=r(t.params)),r=l.getTrustedResourceUrl(r),e.isDefined(r)&&(t.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(t){return t.data}))),e.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){t==m.current&&(t&&(t.locals=a,e.copy(t.params,i)),n.$broadcast("$routeChangeSuccess",t,r))},function(e){t==m.current&&n.$broadcast("$routeChangeError",t,r,e)}))}function p(){var n,i;return e.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=t(r,{params:e.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&t(r[null],{params:{},pathParams:{}})}function d(t,n){var r=[];return e.forEach((t||"").split(":"),function(t,e){if(0===e)r.push(t);else{var a=t.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(f)}};return n.$on("$locationChangeSuccess",f),m}]}function a(){this.$get=function(){return{}}}function i(t,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),f&&(r.leave(f),f=null)}function l(){var o=t.current&&t.current.locals,s=o&&o.$template;if(e.isDefined(s)){var l=a.$new(),g=t.current,m=c(l,function(t){r.enter(t,null,f||i,function(){!e.isDefined(p)||p&&!a.$eval(p)||n()}),u()});f=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(d)}else u()}var h,f,p=o.autoscroll,d=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(t,e,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=t(a.contents());if(i.controller){o.$scope=r;var c=e(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=e.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(t,e,n){"use strict";function r(t){var n=[];return c(n,e.noop).chars(t),n.join("")}function a(t){var e={};t=t.split(",");var n;for(n=0;n<t.length;n++)e[t[n]]=!0;return e}function i(t,n){function r(t,r,i,s){if(r=e.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(f,function(t,e,n,r,a){u[e]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(t,r){var a,i=0;if(r=e.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=t;for(c.last=function(){return c[c.length-1]};t;){if(s=!0,c.last()&&y[c.last()]?(t=t.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(t,e){return e=e.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(e)),""}),a("",c.last())):(0===t.indexOf("<!--")?(i=t.indexOf("--",4),i>=0&&t.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(t.substring(4,i)),t=t.substring(i+3),s=!1)):m.test(t)?(i=t.match(m))&&(t=t.replace(i[0],""),s=!1):d.test(t)?(i=t.match(h))&&(t=t.substring(i[0].length),i[0].replace(h,a),s=!1):p.test(t)&&(i=t.match(l))&&(t=t.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=t.indexOf("<"),s=0>i?t:t.substring(0,i),t=0>i?"":t.substring(i),n.chars&&n.chars(o(s)))),t==v)throw u("badparse",t);v=t}a()}function o(t){if(!t)return"";var e=E.exec(t);t=e[1];var n=e[3];return(e=e[2])&&(D.innerHTML=e.replace(/</g,"&lt;"),e="textContent"in D?D.textContent:D.innerText),t+e+n}function s(t){return t.replace(/&/g,"&amp;").replace(v,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(t,n){var r=!1,a=e.bind(t,t.push);return{start:function(t,i,o){t=e.lowercase(t),!r&&y[t]&&(r=t),r||!0!==S[t]||(a("<"),a(t),e.forEach(i,function(r,i){var o=e.lowercase(i),c="img"===t&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(t){t=e.lowercase(t),r||!0!==S[t]||(a("</"),a(t),a(">")),t==r&&(r=!1)},chars:function(t){r||a(s(t))}}}var u=e.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,f=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,p=/^</,d=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");t=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=e.extend({},n,t),x=e.extend({},t,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=e.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),y=a("script,style"),S=e.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=e.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;e.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(t){return function(e){var n=[];return i(e,c(n,function(e,n){return!/^unsafe/.test(t(e,n))})),n.join("")}}]}),e.module("ngSanitize").filter("linky",["$sanitize",function(t){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(t){t&&p.push(r(t))}function c(t,n){p.push("<a "),e.isDefined(o)&&(p.push('target="'),p.push(o),p.push('" ')),p.push('href="'),p.push(t),p.push('">'),s(n),p.push("</a>")}if(!i)return i;for(var u,l,h,f=i,p=[];u=f.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(f.substr(0,h)),c(l,u[0].replace(a,"")),f=f.substring(h+u[0].length);return s(f),t(p.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(t,e){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(e,r){null!=n?r(n):t({url:e+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(t){n=t.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(t){alert("Cannot get digestValue.")})},getFileBuffer:function(t){var n=e.defer(),r=new FileReader;return r.onload=function(t){n.resolve(t.target.result)},r.onerror=function(t){n.reject(t.target.error)},r.readAsArrayBuffer(t),n.promise},addListFileAttachment:function(e,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(e,function(a){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(t){return t},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(t){o(t)},function(t){s(t)})})})},deleteListFileAttachment:function(e,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(e,function(s){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(t){i(t)},function(t){o(t)})})},getListItemType:function(t){return("SP.Data."+t[0].toUpperCase()+t.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(e,n,r,a,i,o){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){i(t)},function(t){o(t)})},getListItems:function(e,n,r,a,i){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){a(t)},function(t){i(t)})},addListItem:function(e,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(e,function(r){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(t){a(t)},function(t){i(t)})})},updateListItem:function(e,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(e,function(a){c(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":e.data.d.__metadata.etag}}).then(function(t){i(t)},function(t){o(t)})},function(t){o(t)})})},deleteListItem:function(e,n,r,a,i){var o=this.getListItem;this.getDigestValue(e,function(s){o(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":e.data.d.__metadata.etag}}).then(function(t){a(t)},function(t){i(t)})},function(t){i(t)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(t){return{$$silentChangePath:!1,silent:function(e,n){this.prev=t.path();var r=t.url(e);n&&r.replace(),this.$$silentChangePath=t.path()},box:function(t,e){e[t].__silentModeMarker||!function(){var n=e[t];e[t]=function(){e[t]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(t,e,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===e.path())for(var i in t.$$listeners.$locationChangeSuccess)n.box(i,t.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,t.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function t(t,e){var n=i.indexOf(t.charAt(e));if(-1==n)throw"Cannot decode base64";return n}function e(e){e=""+e;var n,r,i,o=e.length;if(0==o)return e;if(0!=o%4)throw"Cannot decode base64";n=0,e.charAt(o-1)==a&&(n=1,e.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6|t(e,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=t(e,r)<<18|t(e,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(t,e){var n=t.charCodeAt(e);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(t){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var e,r,o=[];t=""+t;var s=t.length-t.length%3;if(0==t.length)return t;for(e=0;s>e;e+=3)r=n(t,e)<<16|n(t,e+1)<<8|n(t,e+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(t.length-s){case 1:r=n(t,e)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(t,e)<<16|n(t,e+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:e}}())}(),function(t,e,n){"use strict";function r(){function t(t,n){return e.extend(new(e.extend(function(){},{prototype:t})),n)}function n(t,e){var n=e.caseInsensitiveMatch,r={originalPath:t,regexp:t},a=r.keys=[];return t=t.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(t,e,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),e=e||"",""+(i?"":e)+"(?:"+(i?e:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+t+"$",n?"i":""),r}var r={};this.when=function(t,a){if(r[t]=e.extend({reloadOnSearch:!0},a,t&&n(t,a)),t){var i="/"==t[t.length-1]?t.substr(0,t.length-1):t+"/";r[i]=e.extend({redirectTo:t},n(i,a))}return this},this.otherwise=function(t){return this.when(null,t),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(t,e){var n=e.keys,r={};if(!e.regexp)return null;var a=e.regexp.exec(t);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function f(){var t=p(),r=m.current;t&&r&&t.$$route===r.$$route&&e.equals(t.pathParams,r.pathParams)&&!t.reloadOnSearch&&!g?(r.params=t.params,e.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(t||r)&&(g=!1,n.$broadcast("$routeChangeStart",t,r),m.current=t,t&&t.redirectTo&&(e.isString(t.redirectTo)?a.path(d(t.redirectTo,t.params)).search(t.params).replace():a.url(t.redirectTo(t.pathParams,a.path(),a.search())).replace()),o.when(t).then(function(){if(t){var n,r,a=e.extend({},t.resolve);return e.forEach(a,function(t,n){a[n]=e.isString(t)?s.get(t):s.invoke(t)}),e.isDefined(n=t.template)?e.isFunction(n)&&(n=n(t.params)):e.isDefined(r=t.templateUrl)&&(e.isFunction(r)&&(r=r(t.params)),r=l.getTrustedResourceUrl(r),e.isDefined(r)&&(t.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(t){return t.data}))),e.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){t==m.current&&(t&&(t.locals=a,e.copy(t.params,i)),n.$broadcast("$routeChangeSuccess",t,r))},function(e){t==m.current&&n.$broadcast("$routeChangeError",t,r,e)}))}function p(){var n,i;return e.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=t(r,{params:e.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&t(r[null],{params:{},pathParams:{}})}function d(t,n){var r=[];return e.forEach((t||"").split(":"),function(t,e){if(0===e)r.push(t);else{var a=t.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(f)}};return n.$on("$locationChangeSuccess",f),m}]}function a(){this.$get=function(){return{}}}function i(t,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),f&&(r.leave(f),f=null)}function l(){var o=t.current&&t.current.locals,s=o&&o.$template;if(e.isDefined(s)){var l=a.$new(),g=t.current,m=c(l,function(t){r.enter(t,null,f||i,function(){!e.isDefined(p)||p&&!a.$eval(p)||n()}),u()});f=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(d)}else u()}var h,f,p=o.autoscroll,d=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(t,e,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=t(a.contents());if(i.controller){o.$scope=r;var c=e(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=e.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(t,e,n){"use strict";function r(t){var n=[];return c(n,e.noop).chars(t),n.join("")}function a(t){var e={};t=t.split(",");var n;for(n=0;n<t.length;n++)e[t[n]]=!0;return e}function i(t,n){function r(t,r,i,s){if(r=e.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(f,function(t,e,n,r,a){u[e]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(t,r){var a,i=0;if(r=e.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=t;for(c.last=function(){return c[c.length-1]};t;){if(s=!0,c.last()&&y[c.last()]?(t=t.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(t,e){return e=e.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(e)),""}),a("",c.last())):(0===t.indexOf("<!--")?(i=t.indexOf("--",4),i>=0&&t.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(t.substring(4,i)),t=t.substring(i+3),s=!1)):m.test(t)?(i=t.match(m))&&(t=t.replace(i[0],""),s=!1):d.test(t)?(i=t.match(h))&&(t=t.substring(i[0].length),i[0].replace(h,a),s=!1):p.test(t)&&(i=t.match(l))&&(t=t.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=t.indexOf("<"),s=0>i?t:t.substring(0,i),t=0>i?"":t.substring(i),n.chars&&n.chars(o(s)))),t==v)throw u("badparse",t);v=t}a()}function o(t){if(!t)return"";var e=E.exec(t);t=e[1];var n=e[3];return(e=e[2])&&(D.innerHTML=e.replace(/</g,"&lt;"),e="textContent"in D?D.textContent:D.innerText),t+e+n}function s(t){return t.replace(/&/g,"&amp;").replace(v,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(t,n){var r=!1,a=e.bind(t,t.push);return{start:function(t,i,o){t=e.lowercase(t),!r&&y[t]&&(r=t),r||!0!==S[t]||(a("<"),a(t),e.forEach(i,function(r,i){var o=e.lowercase(i),c="img"===t&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(t){t=e.lowercase(t),r||!0!==S[t]||(a("</"),a(t),a(">")),t==r&&(r=!1)},chars:function(t){r||a(s(t))}}}var u=e.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,f=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,p=/^</,d=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");t=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=e.extend({},n,t),x=e.extend({},t,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=e.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),y=a("script,style"),S=e.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=e.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;e.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(t){return function(e){var n=[];return i(e,c(n,function(e,n){return!/^unsafe/.test(t(e,n))})),n.join("")}}]}),e.module("ngSanitize").filter("linky",["$sanitize",function(t){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(t){t&&p.push(r(t))}function c(t,n){p.push("<a "),e.isDefined(o)&&(p.push('target="'),p.push(o),p.push('" ')),p.push('href="'),p.push(t),p.push('">'),s(n),p.push("</a>")}if(!i)return i;for(var u,l,h,f=i,p=[];u=f.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(f.substr(0,h)),c(l,u[0].replace(a,"")),f=f.substring(h+u[0].length);return s(f),t(p.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(t,e){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(e,r){null!=n?r(n):t({url:e+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(t){n=t.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(t){alert("Cannot get digestValue.")})},getFileBuffer:function(t){var n=e.defer(),r=new FileReader;return r.onload=function(t){n.resolve(t.target.result)},r.onerror=function(t){n.reject(t.target.error)},r.readAsArrayBuffer(t),n.promise},addListFileAttachment:function(e,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(e,function(a){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(t){return t},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(t){o(t)},function(t){s(t)})})})},deleteListFileAttachment:function(e,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(e,function(s){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(t){i(t)},function(t){o(t)})})},getListItemType:function(t){return("SP.Data."+t[0].toUpperCase()+t.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(e,n,r,a,i,o){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){i(t)},function(t){o(t)})},getListItems:function(e,n,r,a,i){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){a(t)},function(t){i(t)})},addListItem:function(e,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(e,function(r){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(t){a(t)},function(t){i(t)})})},updateListItem:function(e,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(e,function(a){c(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":e.data.d.__metadata.etag}}).then(function(t){i(t)},function(t){o(t)})},function(t){o(t)})})},deleteListItem:function(e,n,r,a,i){var o=this.getListItem;this.getDigestValue(e,function(s){o(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":e.data.d.__metadata.etag}}).then(function(t){a(t)},function(t){i(t)})},function(t){i(t)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(t){return{$$silentChangePath:!1,silent:function(e,n){this.prev=t.path();var r=t.url(e);n&&r.replace(),this.$$silentChangePath=t.path()},box:function(t,e){e[t].__silentModeMarker||!function(){var n=e[t];e[t]=function(){e[t]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(t,e,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===e.path())for(var i in t.$$listeners.$locationChangeSuccess)n.box(i,t.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,t.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function t(t,e){var n=i.indexOf(t.charAt(e));if(-1==n)throw"Cannot decode base64";return n}function e(e){e=""+e;var n,r,i,o=e.length;if(0==o)return e;if(0!=o%4)throw"Cannot decode base64";n=0,e.charAt(o-1)==a&&(n=1,e.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6|t(e,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=t(e,r)<<18|t(e,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(t,e){var n=t.charCodeAt(e);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(t){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var e,r,o=[];t=""+t;var s=t.length-t.length%3;if(0==t.length)return t;for(e=0;s>e;e+=3)r=n(t,e)<<16|n(t,e+1)<<8|n(t,e+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(t.length-s){case 1:r=n(t,e)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(t,e)<<16|n(t,e+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:e}}())}(),function(t,e,n){"use strict";function r(){function t(t,n){return e.extend(new(e.extend(function(){},{prototype:t})),n)}function n(t,e){var n=e.caseInsensitiveMatch,r={originalPath:t,regexp:t},a=r.keys=[];return t=t.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(t,e,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),e=e||"",""+(i?"":e)+"(?:"+(i?e:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+t+"$",n?"i":""),r}var r={};this.when=function(t,a){if(r[t]=e.extend({reloadOnSearch:!0},a,t&&n(t,a)),t){var i="/"==t[t.length-1]?t.substr(0,t.length-1):t+"/";r[i]=e.extend({redirectTo:t},n(i,a))}return this},this.otherwise=function(t){return this.when(null,t),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(t,e){var n=e.keys,r={};if(!e.regexp)return null;var a=e.regexp.exec(t);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function f(){var t=p(),r=m.current;t&&r&&t.$$route===r.$$route&&e.equals(t.pathParams,r.pathParams)&&!t.reloadOnSearch&&!g?(r.params=t.params,e.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(t||r)&&(g=!1,n.$broadcast("$routeChangeStart",t,r),m.current=t,t&&t.redirectTo&&(e.isString(t.redirectTo)?a.path(d(t.redirectTo,t.params)).search(t.params).replace():a.url(t.redirectTo(t.pathParams,a.path(),a.search())).replace()),o.when(t).then(function(){if(t){var n,r,a=e.extend({},t.resolve);return e.forEach(a,function(t,n){a[n]=e.isString(t)?s.get(t):s.invoke(t)}),e.isDefined(n=t.template)?e.isFunction(n)&&(n=n(t.params)):e.isDefined(r=t.templateUrl)&&(e.isFunction(r)&&(r=r(t.params)),r=l.getTrustedResourceUrl(r),e.isDefined(r)&&(t.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(t){return t.data}))),e.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){t==m.current&&(t&&(t.locals=a,e.copy(t.params,i)),n.$broadcast("$routeChangeSuccess",t,r))},function(e){t==m.current&&n.$broadcast("$routeChangeError",t,r,e);

}))}function p(){var n,i;return e.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=t(r,{params:e.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&t(r[null],{params:{},pathParams:{}})}function d(t,n){var r=[];return e.forEach((t||"").split(":"),function(t,e){if(0===e)r.push(t);else{var a=t.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(f)}};return n.$on("$locationChangeSuccess",f),m}]}function a(){this.$get=function(){return{}}}function i(t,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),f&&(r.leave(f),f=null)}function l(){var o=t.current&&t.current.locals,s=o&&o.$template;if(e.isDefined(s)){var l=a.$new(),g=t.current,m=c(l,function(t){r.enter(t,null,f||i,function(){!e.isDefined(p)||p&&!a.$eval(p)||n()}),u()});f=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(d)}else u()}var h,f,p=o.autoscroll,d=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(t,e,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=t(a.contents());if(i.controller){o.$scope=r;var c=e(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=e.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(t,e,n){"use strict";function r(t){var n=[];return c(n,e.noop).chars(t),n.join("")}function a(t){var e={};t=t.split(",");var n;for(n=0;n<t.length;n++)e[t[n]]=!0;return e}function i(t,n){function r(t,r,i,s){if(r=e.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(f,function(t,e,n,r,a){u[e]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(t,r){var a,i=0;if(r=e.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=t;for(c.last=function(){return c[c.length-1]};t;){if(s=!0,c.last()&&y[c.last()]?(t=t.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(t,e){return e=e.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(e)),""}),a("",c.last())):(0===t.indexOf("<!--")?(i=t.indexOf("--",4),i>=0&&t.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(t.substring(4,i)),t=t.substring(i+3),s=!1)):m.test(t)?(i=t.match(m))&&(t=t.replace(i[0],""),s=!1):d.test(t)?(i=t.match(h))&&(t=t.substring(i[0].length),i[0].replace(h,a),s=!1):p.test(t)&&(i=t.match(l))&&(t=t.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=t.indexOf("<"),s=0>i?t:t.substring(0,i),t=0>i?"":t.substring(i),n.chars&&n.chars(o(s)))),t==v)throw u("badparse",t);v=t}a()}function o(t){if(!t)return"";var e=E.exec(t);t=e[1];var n=e[3];return(e=e[2])&&(D.innerHTML=e.replace(/</g,"&lt;"),e="textContent"in D?D.textContent:D.innerText),t+e+n}function s(t){return t.replace(/&/g,"&amp;").replace(v,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(t,n){var r=!1,a=e.bind(t,t.push);return{start:function(t,i,o){t=e.lowercase(t),!r&&y[t]&&(r=t),r||!0!==S[t]||(a("<"),a(t),e.forEach(i,function(r,i){var o=e.lowercase(i),c="img"===t&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(t){t=e.lowercase(t),r||!0!==S[t]||(a("</"),a(t),a(">")),t==r&&(r=!1)},chars:function(t){r||a(s(t))}}}var u=e.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,f=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,p=/^</,d=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");t=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=e.extend({},n,t),x=e.extend({},t,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=e.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),y=a("script,style"),S=e.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=e.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;e.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(t){return function(e){var n=[];return i(e,c(n,function(e,n){return!/^unsafe/.test(t(e,n))})),n.join("")}}]}),e.module("ngSanitize").filter("linky",["$sanitize",function(t){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(t){t&&p.push(r(t))}function c(t,n){p.push("<a "),e.isDefined(o)&&(p.push('target="'),p.push(o),p.push('" ')),p.push('href="'),p.push(t),p.push('">'),s(n),p.push("</a>")}if(!i)return i;for(var u,l,h,f=i,p=[];u=f.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(f.substr(0,h)),c(l,u[0].replace(a,"")),f=f.substring(h+u[0].length);return s(f),t(p.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(t,e){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(e,r){null!=n?r(n):t({url:e+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(t){n=t.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(t){alert("Cannot get digestValue.")})},getFileBuffer:function(t){var n=e.defer(),r=new FileReader;return r.onload=function(t){n.resolve(t.target.result)},r.onerror=function(t){n.reject(t.target.error)},r.readAsArrayBuffer(t),n.promise},addListFileAttachment:function(e,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(e,function(a){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(t){return t},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(t){o(t)},function(t){s(t)})})})},deleteListFileAttachment:function(e,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(e,function(s){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(t){i(t)},function(t){o(t)})})},getListItemType:function(t){return("SP.Data."+t[0].toUpperCase()+t.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(e,n,r,a,i,o){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){i(t)},function(t){o(t)})},getListItems:function(e,n,r,a,i){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){a(t)},function(t){i(t)})},addListItem:function(e,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(e,function(r){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(t){a(t)},function(t){i(t)})})},updateListItem:function(e,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(e,function(a){c(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":e.data.d.__metadata.etag}}).then(function(t){i(t)},function(t){o(t)})},function(t){o(t)})})},deleteListItem:function(e,n,r,a,i){var o=this.getListItem;this.getDigestValue(e,function(s){o(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":e.data.d.__metadata.etag}}).then(function(t){a(t)},function(t){i(t)})},function(t){i(t)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(t){return{$$silentChangePath:!1,silent:function(e,n){this.prev=t.path();var r=t.url(e);n&&r.replace(),this.$$silentChangePath=t.path()},box:function(t,e){e[t].__silentModeMarker||!function(){var n=e[t];e[t]=function(){e[t]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(t,e,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===e.path())for(var i in t.$$listeners.$locationChangeSuccess)n.box(i,t.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,t.$on("$locationChangeSuccess",r)}]),!function(){"use strict";angular.module("base64",[]).constant("$base64",function(){function t(t,e){var n=i.indexOf(t.charAt(e));if(-1==n)throw"Cannot decode base64";return n}function e(e){e=""+e;var n,r,i,o=e.length;if(0==o)return e;if(0!=o%4)throw"Cannot decode base64";n=0,e.charAt(o-1)==a&&(n=1,e.charAt(o-2)==a&&(n=2),o-=4);var s=[];for(r=0;o>r;r+=4)i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6|t(e,r+3),s.push(String.fromCharCode(i>>16,255&i>>8,255&i));switch(n){case 1:i=t(e,r)<<18|t(e,r+1)<<12|t(e,r+2)<<6,s.push(String.fromCharCode(i>>16,255&i>>8));break;case 2:i=t(e,r)<<18|t(e,r+1)<<12,s.push(String.fromCharCode(i>>16))}return s.join("")}function n(t,e){var n=t.charCodeAt(e);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n}function r(t){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var e,r,o=[];t=""+t;var s=t.length-t.length%3;if(0==t.length)return t;for(e=0;s>e;e+=3)r=n(t,e)<<16|n(t,e+1)<<8|n(t,e+2),o.push(i.charAt(r>>18)),o.push(i.charAt(63&r>>12)),o.push(i.charAt(63&r>>6)),o.push(i.charAt(63&r));switch(t.length-s){case 1:r=n(t,e)<<16,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+a+a);break;case 2:r=n(t,e)<<16|n(t,e+1)<<8,o.push(i.charAt(r>>18)+i.charAt(63&r>>12)+i.charAt(63&r>>6)+a)}return o.join("")}var a="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{encode:r,decode:e}}())}(),function(t,e,n){"use strict";function r(){function t(t,n){return e.extend(new(e.extend(function(){},{prototype:t})),n)}function n(t,e){var n=e.caseInsensitiveMatch,r={originalPath:t,regexp:t},a=r.keys=[];return t=t.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?|\*])?/g,function(t,e,n,r){var i="?"===r?r:null,o="*"===r?r:null;return a.push({name:n,optional:!!i}),e=e||"",""+(i?"":e)+"(?:"+(i?e:"")+(o&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+t+"$",n?"i":""),r}var r={};this.when=function(t,a){if(r[t]=e.extend({reloadOnSearch:!0},a,t&&n(t,a)),t){var i="/"==t[t.length-1]?t.substr(0,t.length-1):t+"/";r[i]=e.extend({redirectTo:t},n(i,a))}return this},this.otherwise=function(t){return this.when(null,t),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,a,i,o,s,c,u,l){function h(t,e){var n=e.keys,r={};if(!e.regexp)return null;var a=e.regexp.exec(t);if(!a)return null;for(var i=1,o=a.length;o>i;++i){var s=n[i-1],c="string"==typeof a[i]?decodeURIComponent(a[i]):a[i];s&&c&&(r[s.name]=c)}return r}function f(){var t=p(),r=m.current;t&&r&&t.$$route===r.$$route&&e.equals(t.pathParams,r.pathParams)&&!t.reloadOnSearch&&!g?(r.params=t.params,e.copy(r.params,i),n.$broadcast("$routeUpdate",r)):(t||r)&&(g=!1,n.$broadcast("$routeChangeStart",t,r),m.current=t,t&&t.redirectTo&&(e.isString(t.redirectTo)?a.path(d(t.redirectTo,t.params)).search(t.params).replace():a.url(t.redirectTo(t.pathParams,a.path(),a.search())).replace()),o.when(t).then(function(){if(t){var n,r,a=e.extend({},t.resolve);return e.forEach(a,function(t,n){a[n]=e.isString(t)?s.get(t):s.invoke(t)}),e.isDefined(n=t.template)?e.isFunction(n)&&(n=n(t.params)):e.isDefined(r=t.templateUrl)&&(e.isFunction(r)&&(r=r(t.params)),r=l.getTrustedResourceUrl(r),e.isDefined(r)&&(t.loadedTemplateUrl=r,n=c.get(r,{cache:u}).then(function(t){return t.data}))),e.isDefined(n)&&(a.$template=n),o.all(a)}}).then(function(a){t==m.current&&(t&&(t.locals=a,e.copy(t.params,i)),n.$broadcast("$routeChangeSuccess",t,r))},function(e){t==m.current&&n.$broadcast("$routeChangeError",t,r,e)}))}function p(){var n,i;return e.forEach(r,function(r,o){!i&&(n=h(a.path(),r))&&(i=t(r,{params:e.extend({},a.search(),n),pathParams:n}),i.$$route=r)}),i||r[null]&&t(r[null],{params:{},pathParams:{}})}function d(t,n){var r=[];return e.forEach((t||"").split(":"),function(t,e){if(0===e)r.push(t);else{var a=t.match(/(\w+)(.*)/),i=a[1];r.push(n[i]),r.push(a[2]||""),delete n[i]}}),r.join("")}var g=!1,m={routes:r,reload:function(){g=!0,n.$evalAsync(f)}};return n.$on("$locationChangeSuccess",f),m}]}function a(){this.$get=function(){return{}}}function i(t,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,i,o,s,c){function u(){h&&(h.$destroy(),h=null),f&&(r.leave(f),f=null)}function l(){var o=t.current&&t.current.locals,s=o&&o.$template;if(e.isDefined(s)){var l=a.$new(),g=t.current,m=c(l,function(t){r.enter(t,null,f||i,function(){!e.isDefined(p)||p&&!a.$eval(p)||n()}),u()});f=m,h=g.scope=l,h.$emit("$viewContentLoaded"),h.$eval(d)}else u()}var h,f,p=o.autoscroll,d=o.onload||"";a.$on("$routeChangeSuccess",l),l()}}}function o(t,e,n){return{restrict:"ECA",priority:-400,link:function(r,a){var i=n.current,o=i.locals;a.html(o.$template);var s=t(a.contents());if(i.controller){o.$scope=r;var c=e(i.controller,o);i.controllerAs&&(r[i.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c)}s(r)}}}var s=e.module("ngRoute",["ng"]).provider("$route",r);s.provider("$routeParams",a),s.directive("ngView",i),s.directive("ngView",o),i.$inject=["$route","$anchorScroll","$animate"],o.$inject=["$compile","$controller","$route"]}(window,window.angular),function(t,e,n){"use strict";function r(t){var n=[];return c(n,e.noop).chars(t),n.join("")}function a(t){var e={};t=t.split(",");var n;for(n=0;n<t.length;n++)e[t[n]]=!0;return e}function i(t,n){function r(t,r,i,s){if(r=e.lowercase(r),x[r])for(;c.last()&&C[c.last()];)a("",c.last());w[r]&&c.last()==r&&a("",r),(s=b[r]||!!s)||c.push(r);var u={};i.replace(f,function(t,e,n,r,a){u[e]=o(n||r||a||"")}),n.start&&n.start(r,u,s)}function a(t,r){var a,i=0;if(r=e.lowercase(r))for(i=c.length-1;i>=0&&c[i]!=r;i--);if(i>=0){for(a=c.length-1;a>=i;a--)n.end&&n.end(c[a]);c.length=i}}var i,s,c=[],v=t;for(c.last=function(){return c[c.length-1]};t;){if(s=!0,c.last()&&y[c.last()]?(t=t.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(t,e){return e=e.replace(g,"$1").replace($,"$1"),n.chars&&n.chars(o(e)),""}),a("",c.last())):(0===t.indexOf("<!--")?(i=t.indexOf("--",4),i>=0&&t.lastIndexOf("-->",i)===i&&(n.comment&&n.comment(t.substring(4,i)),t=t.substring(i+3),s=!1)):m.test(t)?(i=t.match(m))&&(t=t.replace(i[0],""),s=!1):d.test(t)?(i=t.match(h))&&(t=t.substring(i[0].length),i[0].replace(h,a),s=!1):p.test(t)&&(i=t.match(l))&&(t=t.substring(i[0].length),i[0].replace(l,r),s=!1),s&&(i=t.indexOf("<"),s=0>i?t:t.substring(0,i),t=0>i?"":t.substring(i),n.chars&&n.chars(o(s)))),t==v)throw u("badparse",t);v=t}a()}function o(t){if(!t)return"";var e=E.exec(t);t=e[1];var n=e[3];return(e=e[2])&&(D.innerHTML=e.replace(/</g,"&lt;"),e="textContent"in D?D.textContent:D.innerText),t+e+n}function s(t){return t.replace(/&/g,"&amp;").replace(v,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(t,n){var r=!1,a=e.bind(t,t.push);return{start:function(t,i,o){t=e.lowercase(t),!r&&y[t]&&(r=t),r||!0!==S[t]||(a("<"),a(t),e.forEach(i,function(r,i){var o=e.lowercase(i),c="img"===t&&"src"===o||"background"===o;!0!==T[o]||!0===A[o]&&!n(r,c)||(a(" "),a(i),a('="'),a(s(r)),a('"'))}),a(o?"/>":">"))},end:function(t){t=e.lowercase(t),r||!0!==S[t]||(a("</"),a(t),a(">")),t==r&&(r=!1)},chars:function(t){r||a(s(t))}}}var u=e.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,h=/^<\s*\/\s*([\w:-]+)[^>]*>/,f=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,p=/^</,d=/^<\s*\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,$=/<!\[CDATA\[(.*?)]]\x3e/g,v=/([^\#-~| |!])/g,b=a("area,br,col,hr,img,wbr");t=a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=a("rp,rt");var w=e.extend({},n,t),x=e.extend({},t,a("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=e.extend({},n,a("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),y=a("script,style"),S=e.extend({},b,x,C,w),A=a("background,cite,href,longdesc,src,usemap"),T=e.extend({},A,a("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;e.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(t){return function(e){var n=[];return i(e,c(n,function(e,n){return!/^unsafe/.test(t(e,n))})),n.join("")}}]}),e.module("ngSanitize").filter("linky",["$sanitize",function(t){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,a=/^mailto:/;return function(i,o){function s(t){t&&p.push(r(t))}function c(t,n){p.push("<a "),e.isDefined(o)&&(p.push('target="'),p.push(o),p.push('" ')),p.push('href="'),p.push(t),p.push('">'),s(n),p.push("</a>")}if(!i)return i;for(var u,l,h,f=i,p=[];u=f.match(n);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),h=u.index,s(f.substr(0,h)),c(l,u[0].replace(a,"")),f=f.substring(h+u[0].length);return s(f),t(p.join(""))}}])}(window,window.angular),angular.module("customServices",[]).factory("spService",["$http","$q",function(t,e){var n=angular.element(document.querySelector("#__REQUESTDIGEST")).val();return{getDigestValue:function(e,r){null!=n?r(n):t({url:e+"/_api/contextinfo",async:!0,method:"POST",headers:{accept:"application/json;odata=verbose",contentType:"text/xml"}}).then(function(t){n=t.data.d.GetContextWebInformation.FormDigestValue,r(n)},function(t){alert("Cannot get digestValue.")})},getFileBuffer:function(t){var n=e.defer(),r=new FileReader;return r.onload=function(t){n.resolve(t.target.result)},r.onerror=function(t){n.reject(t.target.error)},r.readAsArrayBuffer(t),n.promise},addListFileAttachment:function(e,n,r,a,i,o,s){getDigestValue=this.getDigestValue,this.getFileBuffer(i).then(function(i){var c=a.replace(/^\.+|([|\/&;$%:#~?^{}*'@"<>()+,])|\.+$/g,"");c=c.substr(-128),getDigestValue(e,function(a){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/add(FileName='"+c+"')",method:"POST",data:i,processData:!1,transformRequest:function(t){return t},headers:{Accept:"application/json;odata=verbose","X-RequestDigest":a,"Content-Length":i.byteLength}}).then(function(t){o(t)},function(t){s(t)})})})},deleteListFileAttachment:function(e,n,r,a,i,o){getDigestValue=this.getDigestValue,getDigestValue(e,function(s){t({url:e+"/_api/web/lists/GetByTitle('"+n+"')/items("+r+")/AttachmentFiles/getByFileName('"+a+"')",method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s}}).then(function(t){i(t)},function(t){o(t)})})},getListItemType:function(t){return("SP.Data."+t[0].toUpperCase()+t.substring(1)+"ListItem").replace(" ","_x0020_")},getListItem:function(e,n,r,a,i,o){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items('"+r+"')"+a,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){i(t)},function(t){o(t)})},getListItems:function(e,n,r,a,i){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items"+r,method:"GET",headers:{Accept:"application/json; odata=verbose"}}).then(function(t){a(t)},function(t){i(t)})},addListItem:function(e,n,r,a,i){var o=angular.extend({__metadata:{type:this.getListItemType(n)}},r);this.getDigestValue(e,function(r){t({url:e+"/_api/web/lists/getbytitle('"+n+"')/items",method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":r}}).then(function(t){a(t)},function(t){i(t)})})},updateListItem:function(e,n,r,a,i,o){var s=angular.extend({__metadata:{type:this.getListItemType(n)}},a),c=this.getListItem;this.getDigestValue(e,function(a){c(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",data:JSON.stringify(s),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":a,"X-HTTP-Method":"MERGE","If-Match":e.data.d.__metadata.etag}}).then(function(t){i(t)},function(t){o(t)})},function(t){o(t)})})},deleteListItem:function(e,n,r,a,i){var o=this.getListItem;this.getDigestValue(e,function(s){o(e,n,r,"",function(e){t({url:e.data.d.__metadata.uri,method:"POST",headers:{Accept:"application/json;odata=verbose","X-Http-Method":"DELETE","X-RequestDigest":s,"If-Match":e.data.d.__metadata.etag}}).then(function(t){a(t)},function(t){i(t)})},function(t){i(t)})})}}}]),angular.module("ngSilent",[]).factory("$ngSilentLocation",["$location",function(t){return{$$silentChangePath:!1,silent:function(e,n){this.prev=t.path();var r=t.url(e);n&&r.replace(),this.$$silentChangePath=t.path()},box:function(t,e){e[t].__silentModeMarker||!function(){var n=e[t];e[t]=function(){e[t]=n}}()}}}]).run(["$rootScope","$location","$ngSilentLocation",function(t,e,n){var r=function(r){var a=n.$$silentChangePath;if(n.$$silentChangePath=!1,a===e.path())for(var i in t.$$listeners.$locationChangeSuccess)n.box(i,t.$$listeners.$locationChangeSuccess)};r.__silentModeMarker=!0,t.$on("$locationChangeSuccess",r)}]);